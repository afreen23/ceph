(self.webpackChunkceph_dashboard=self.webpackChunkceph_dashboard||[]).push([["src_app_ceph_pool_pool_module_ts"],{82301:(l_,we,r)=>{r.r(we),r.d(we,{PoolModule:()=>y,RoutedPoolModule:()=>Ne});var h=r(91974),l=r(53648),ge=r(76218),E=r(77317),g=r(54372),Tt=r(93887),Nt=r(11430),At=r(26481),e=r(87536),vt=r(29841),p=r.n(vt),bt=r(95631),It=r(5155),ke=r(17612),$t=r(36618);class T{constructor(t){this.http=t,this.apiPath="api/erasure_code_profile",this.formTooltips={k:$localize`Each object is split in data-chunks parts, each stored on a different OSD.`,m:$localize`Compute coding chunks for each object and store them on different OSDs.
      The number of coding chunks is also the number of OSDs that can be down without losing data.`,plugins:{jerasure:{description:$localize`The jerasure plugin is the most generic and flexible plugin,
          it is also the default for Ceph erasure coded pools.`,technique:$localize`The more flexible technique is reed_sol_van : it is enough to set k
          and m. The cauchy_good technique can be faster but you need to chose the packetsize
          carefully. All of reed_sol_r6_op, liberation, blaum_roth, liber8tion are RAID6 equivalents
          in the sense that they can only be configured with m=2.`,packetSize:$localize`The encoding will be done on packets of bytes size at a time.
          Choosing the right packet size is difficult.
          The jerasure documentation contains extensive information on this topic.`},lrc:{description:$localize`With the jerasure plugin, when an erasure coded object is stored on
          multiple OSDs, recovering from the loss of one OSD requires reading from all the others.
          For instance if jerasure is configured with k=8 and m=4, losing one OSD requires reading
          from the eleven others to repair.

          The lrc erasure code plugin creates local parity chunks to be able to recover using
          less OSDs. For instance if lrc is configured with k=8, m=4 and l=4, it will create
          an additional parity chunk for every four OSDs. When a single OSD is lost, it can be
          recovered with only four OSDs instead of eleven.`,l:$localize`Group the coding and data chunks into sets of size locality. For instance,
          for k=4 and m=2, when locality=3 two groups of three are created. Each set can
          be recovered without reading chunks from another set.`,crushLocality:$localize`The type of the crush bucket in which each set of chunks defined
          by l will be stored. For instance, if it is set to rack, each group of l chunks will be
          placed in a different rack. It is used to create a CRUSH rule step such as step choose
          rack. If it is not set, no such grouping is done.`},isa:{description:$localize`The isa plugin encapsulates the ISA library. It only runs on Intel processors.`,technique:$localize`The ISA plugin comes in two Reed Solomon forms.
          If reed_sol_van is set, it is Vandermonde, if cauchy is set, it is Cauchy.`},shec:{description:$localize`The shec plugin encapsulates the multiple SHEC library.
          It allows ceph to recover data more efficiently than Reed Solomon codes.`,c:$localize`The number of parity chunks each of which includes each data chunk in its
          calculation range. The number is used as a durability estimator. For instance, if c=2,
          2 OSDs can be down without losing data.`},clay:{description:$localize`CLAY (short for coupled-layer) codes are erasure codes designed to
          bring about significant savings in terms of network bandwidth and disk IO when a failed
          node/OSD/rack is being repaired.`,d:$localize`Number of OSDs requested to send data during recovery of a single chunk.
          d needs to be chosen such that k+1 <= d <= k+m-1. The larger the d, the better
          the savings.`,scalar_mds:$localize`scalar_mds specifies the plugin that is used as a building block
          in the layered construction. It can be one of jerasure, isa, shec.`,technique:$localize`technique specifies the technique that will be picked
          within the 'scalar_mds' plugin specified. Supported techniques
          are 'reed_sol_van', 'reed_sol_r6_op', 'cauchy_orig',
          'cauchy_good', 'liber8tion' for jerasure, 'reed_sol_van',
          'cauchy' for isa and 'single', 'multiple' for shec.`}},crushRoot:$localize`The name of the crush bucket used for the first step of the CRUSH rule.
      For instance step take default.`,crushFailureDomain:$localize`Ensure that no two chunks are in a bucket with the same failure
      domain. For instance, if the failure domain is host no two chunks will be stored on the same
      host. It is used to create a CRUSH rule step such as step chooseleaf host.`,crushNumFailureDomains:$localize` Number of failure domains to map. Results in a CRUSH MSR rule being created.
    Must be specified if crush-osds-per-failure-domain is specified.`,crushOsdsPerFailureDomain:$localize`Maximum number of OSDs to place in each failure domain --
     defaults to 1. Using a value greater than one will cause a CRUSH MSR rule to be created.
      Must be specified if crush-num-failure-domains is specified.`,crushDeviceClass:$localize`The device class on which to place data.`,directory:$localize`Set the directory name from which the erasure code plugin is loaded.`}}list(){return this.http.get(this.apiPath)}create(t){return this.http.post(this.apiPath,t,{observe:"response"})}delete(t){return this.http.delete(`${this.apiPath}/${t}`,{observe:"response"})}getInfo(){return this.http.get(`ui-${this.apiPath}/info`)}static{this.\u0275fac=function(n){return new(n||T)(e.\u0275\u0275inject($t.HttpClient))}}static{this.\u0275prov=e.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac,providedIn:"root"})}}var b,o,Ae=r(59870);class Dt{}(o=b||(b={})).Osd="osd",o.Host="host";class F{constructor(){this.nodes=[],this.idTree={},this.allDevices=[],this.buckets=[],this.failureDomains={},this.failureDomainKeys=[],this.devices=[],this.deviceCount=0,this.autoDeviceUpdate=!0}static searchFailureDomains(t,n){return this.getFailureDomains(this.search(t,n))}static search(t,n){const[i,_]=n.split("~"),s=t.find(d=>["name","id","type"].some(O=>d[O]===i));return s?(t=this.getSubNodes(s,this.createIdTreeFromNodes(t)),_&&(t=this.filterNodesByDeviceType(t,_)),t):[]}static createIdTreeFromNodes(t){const n={};return t.forEach(i=>{n[i.id]=i}),n}static getSubNodes(t,n){let i=[t];return t.children&&t.children.forEach(_=>{const s=n[_];i=i.concat(this.getSubNodes(s,n))}),i}static filterNodesByDeviceType(t,n){let _,i=t.filter(d=>d.device_class&&d.device_class!==n).map(d=>d.id),s=i;do{_=!1,t=t.filter(O=>!i.includes(O.id));const d=[];t.forEach(O=>{O.children&&O.children.every(u=>i.includes(u))&&(d.push(O.id),_=!0)}),_&&(i=d,s=s.concat(d))}while(_);return t=(t=p().cloneDeep(t)).map(d=>(d.children&&(d.children=d.children.filter(O=>!s.includes(O))),d))}static getFailureDomains(t){const n={};return t.forEach(i=>{const _=i.type;n[_]||(n[_]=[]),n[_].push(i)}),n}initCrushNodeSelection(t,n,i,_,s=!0){this.autoDeviceUpdate=s,this.nodes=t,this.idTree=F.createIdTreeFromNodes(t),t.forEach(d=>{this.idTree[d.id]=d}),this.buckets=p().sortBy(t.filter(d=>d.children),"name"),this.controls={root:n,failure:i,device:_},this.preSelectRoot(),this.controls.root.valueChanges.subscribe(()=>this.onRootChange()),this.controls.failure.valueChanges.subscribe(()=>this.onFailureDomainChange()),this.controls.device.valueChanges.subscribe(()=>this.onDeviceChange())}preSelectRoot(){const t=this.nodes.find(n=>"root"===n.type);this.silentSet(this.controls.root,t),this.onRootChange()}silentSet(t,n){t.setValue(n,{emitEvent:!1})}onRootChange(){const t=F.getSubNodes(this.controls.root.value,this.idTree),n=F.getFailureDomains(t);Object.keys(n).forEach(i=>{n[i].length<=1&&delete n[i]}),this.failureDomains=n,this.failureDomainKeys=Object.keys(n).sort(),this.updateFailureDomain()}updateFailureDomain(){let t=this.getIncludedCustomValue(this.controls.failure,Object.keys(this.failureDomains));""===t&&(t=this.setMostCommonDomain(this.controls.failure)),this.updateDevices(t)}getIncludedCustomValue(t,n){return t.dirty&&n.includes(t.value)?t.value:""}setMostCommonDomain(t){let n={n:0,type:""};return Object.keys(this.failureDomains).forEach(i=>{const _=this.failureDomains[i].length;n.n<_&&(n={n:_,type:i})}),this.silentSet(t,n.type),n.type}onFailureDomainChange(){this.updateDevices()}updateDevices(t=this.controls.failure.value){if(t===b.Host)this.allDevices=this.failureDomains[t].filter(n=>n.type).map(n=>n.type),this.onDeviceChange("");else{const n=p().flatten(this.failureDomains[t].map(_=>F.getSubNodes(_,this.idTree)));this.allDevices=n.filter(_=>_.device_class).map(_=>_.device_class),this.devices=p().uniq(this.allDevices).sort();const i=1===this.devices.length?this.devices[0]:this.getIncludedCustomValue(this.controls.device,this.devices);this.autoDeviceUpdate&&this.silentSet(this.controls.device,i),this.onDeviceChange(i)}}onDeviceChange(t=this.controls.device.value){this.deviceCount=""===t?this.allDevices.length:this.allDevices.filter(n=>n===t).length}}var Be=r(84821),yt=r(31345),I=r(46045),xt=r(74902),je=r(58384),m=r(3687),Ut=r(6107),$=r(85481),Gt=r(73651),qe=r(82254),zt=r(12540),Ht=r(77867),Me=r(50813),Qe=r(43808),ve=r(55472),Je=r(69081),be=r(59781),Ie=r(64333),$e=r(23603),De=r(90476),ye=r(10142),xe=r(78708),Ue=r(37966),Ge=r(37353);function Xt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",38),e.\u0275\u0275i18n(1,8),e.\u0275\u0275elementEnd())}function Vt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",38),e.\u0275\u0275i18n(1,9),e.\u0275\u0275elementEnd())}function wt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",38),e.\u0275\u0275i18n(1,10),e.\u0275\u0275elementEnd())}function kt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",35),e.\u0275\u0275i18n(1,11),e.\u0275\u0275elementEnd())}function Bt(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function jt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",38),e.\u0275\u0275i18n(1,12),e.\u0275\u0275elementEnd())}function qt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",35),e.\u0275\u0275i18n(1,13),e.\u0275\u0275elementEnd())}function Qt(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate2(" ",n," ( ",i.failureDomains[n].length," ) ")}}function Jt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",38),e.\u0275\u0275i18n(1,14),e.\u0275\u0275elementEnd())}function Kt(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}class Se extends F{constructor(t,n,i,_,s){super(),this.formBuilder=t,this.activeModal=n,this.taskWrapper=i,this.crushRuleService=_,this.actionLabels=s,this.submitAction=new e.EventEmitter,this.action=this.actionLabels.CREATE,this.resource=$localize`Crush Rule`,this.createForm()}createForm(){this.form=this.formBuilder.group({name:["",[l.Validators.required,l.Validators.pattern("[A-Za-z0-9_-]+"),m.xQ.custom("uniqueName",t=>this.names&&-1!==this.names.indexOf(t))]],root:null,failure_domain:"",device_class:""})}ngOnInit(){this.tooltips=this.crushRuleService.formTooltips,this.crushRuleService.getInfo().subscribe(({names:t,nodes:n})=>{this.initCrushNodeSelection(n,this.form.get("root"),this.form.get("failure_domain"),this.form.get("device_class"),!1),this.names=t})}onSubmit(){if(this.form.invalid)return void this.form.setErrors({cdSubmitButton:!0});const t=p().cloneDeep(this.form.value);t.root=t.root.name,""===t.device_class&&delete t.device_class,this.taskWrapper.wrapTaskAroundCall({task:new $.O("crushRule/create",t),call:this.crushRuleService.create(t)}).subscribe({error:()=>{this.form.setErrors({cdSubmitButton:!0})},complete:()=>{this.activeModal.close(),this.submitAction.emit(t)}})}static{this.\u0275fac=function(n){return new(n||Se)(e.\u0275\u0275directiveInject(Qe.$),e.\u0275\u0275directiveInject(E.NgbActiveModal),e.\u0275\u0275directiveInject(Me.a),e.\u0275\u0275directiveInject(ke.j),e.\u0275\u0275directiveInject(g.Ss))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Se,selectors:[["cd-crush-rule-form-modal"]],outputs:{submitAction:"submitAction"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:57,vars:27,consts:()=>{let t,n,i,_,s,d,O,u,P,M,S,C,R,L;return t=$localize`:form title␟fb127ea03835b3230f0ed981c7080e2ccb879621␟3346778808274133574:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,n=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,i=$localize`:␟35a4206db3105ed03e0dd799e1642b75b78123e8␟9169367680120922814:Root`,_=$localize`:␟cf425784c7073c7e7f7c1bb90c2c19db7e751db2␟4525362715759041227:Failure domain type`,s=$localize`:␟72396a9565cf644d1fe1b21b790c4243ee270986␟7136079353894161076:Device class`,d=$localize`:␟74f31fc7133681cf2c20cfb9e350e2447cb7091e␟5916475565738124222:All devices`,O=$localize`:␟34dac8ff3c1f63682b159fe93da9b05527250d21␟5139354158419018287:${"\ufffd0\ufffd"}:INTERPOLATION:`,u=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,P=$localize`:␟490e15ecc922965b6d8194754c87c5583aa071f3␟1576206503438015503:The name can only consist of alphanumeric characters, dashes and underscores.`,M=$localize`:␟9edc2b494e660618af3e5225f68d40b7ca67629c␟1951556666035670157:The chosen erasure code profile name is already in use.`,S=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,C=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,R=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,L=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,[["frm","ngForm"],t,n,i,_,s,d,O,u,P,M,S,C,R,L,[3,"modalRef"],[1,"modal-title"],[1,"modal-content"],["novalidate","",3,"formGroup"],[1,"modal-body"],[1,"form-group","row"],["for","name",1,"cd-col-form-label"],[1,"required"],[1,"cd-col-form-input"],["type","text","id","name","name","name","placeholder","Name...","formControlName","name","autofocus","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","root",1,"cd-col-form-label"],[3,"html"],["id","root","name","root","formControlName","root",1,"form-select"],["ngValue","",4,"ngIf"],[3,"ngValue",4,"ngFor","ngForOf"],["for","failure_domain",1,"cd-col-form-label"],["id","failure_domain","name","failure_domain","formControlName","failure_domain",1,"form-select"],["for","device_class",1,"cd-col-form-label"],["id","device_class","name","device_class","formControlName","device_class",1,"form-select"],["ngValue",""],[1,"modal-footer"],[3,"submitActionEvent","form","submitText"],[1,"invalid-feedback"],[3,"ngValue"]]},template:function(n,i){if(1&n){const _=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cd-modal",15),e.\u0275\u0275elementContainerStart(1,16),e.\u0275\u0275i18n(2,1),e.\u0275\u0275pipe(3,"titlecase"),e.\u0275\u0275pipe(4,"upperFirst"),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(5,17),e.\u0275\u0275elementStart(6,"form",18,0)(8,"div",19)(9,"div",20)(10,"label",21),e.\u0275\u0275elementContainerStart(11),e.\u0275\u0275i18n(12,2),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(13,"span",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",23),e.\u0275\u0275element(15,"input",24),e.\u0275\u0275template(16,Xt,2,0,"span",25)(17,Vt,2,0,"span",25)(18,wt,2,0,"span",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"div",20)(20,"label",26),e.\u0275\u0275elementContainerStart(21),e.\u0275\u0275i18n(22,3),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(23,"cd-helper",27)(24,"span",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"div",23)(26,"select",28),e.\u0275\u0275template(27,kt,2,0,"option",29)(28,Bt,2,2,"option",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(29,jt,2,0,"span",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(30,"div",20)(31,"label",31),e.\u0275\u0275elementContainerStart(32),e.\u0275\u0275i18n(33,4),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(34,"cd-helper",27)(35,"span",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"div",23)(37,"select",32),e.\u0275\u0275template(38,qt,2,0,"option",29)(39,Qt,2,3,"option",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(40,Jt,2,0,"span",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(41,"div",20)(42,"label",33),e.\u0275\u0275elementContainerStart(43),e.\u0275\u0275i18n(44,5),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"div",23)(46,"select",34)(47,"option",35),e.\u0275\u0275i18n(48,6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(49,Kt,2,2,"option",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(50,"cd-help-text")(51,"span"),e.\u0275\u0275i18n(52,7),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(53,"div",36)(54,"cd-form-button-panel",37),e.\u0275\u0275pipe(55,"titlecase"),e.\u0275\u0275pipe(56,"upperFirst"),e.\u0275\u0275listener("submitActionEvent",function(){return e.\u0275\u0275restoreView(_),e.\u0275\u0275resetView(i.onSubmit())}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()}if(2&n){const _=e.\u0275\u0275reference(7);e.\u0275\u0275property("modalRef",i.activeModal),e.\u0275\u0275advance(4),e.\u0275\u0275i18nExp(e.\u0275\u0275pipeBind1(3,19,i.action))(e.\u0275\u0275pipeBind1(4,21,i.resource)),e.\u0275\u0275i18nApply(2),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",i.form),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"pattern")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"uniqueName")),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.root),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!i.buckets),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.buckets),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("root",_,"required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.failure_domain),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!i.failureDomains),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.failureDomainKeys),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("failure_domain",_,"required")),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngForOf",i.devices),e.\u0275\u0275advance(3),e.\u0275\u0275i18nExp(i.tooltips.device_class),e.\u0275\u0275i18nApply(52),e.\u0275\u0275advance(2),e.\u0275\u0275property("form",i.form)("submitText",e.\u0275\u0275pipeBind1(55,23,i.action)+" "+e.\u0275\u0275pipeBind1(56,25,i.resource))}},dependencies:[h.NgForOf,h.NgIf,ve.m,Je.z,be.e,Ie.O,$e.B,De.S,ye.a,xe.C,Ue.E,l.\u0275NgNoValidate,l.NgSelectOption,l.\u0275NgSelectMultipleOption,l.DefaultValueAccessor,l.SelectControlValueAccessor,l.NgControlStatus,l.NgControlStatusGroup,l.FormGroupDirective,l.FormControlName,h.TitleCasePipe,Ge.r]})}}var he=r(3600);const Ke=(o,t,n)=>[o,t,n];function Wt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,15),e.\u0275\u0275elementEnd())}function Yt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,16),e.\u0275\u0275elementEnd())}function Zt(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,17),e.\u0275\u0275elementEnd())}function en(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",88),e.\u0275\u0275i18n(1,18),e.\u0275\u0275elementEnd())}function tn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function nn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,19),e.\u0275\u0275elementEnd())}function on(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,20),e.\u0275\u0275elementEnd())}function _n(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,21),e.\u0275\u0275elementEnd())}function an(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,22),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.deviceCount),e.\u0275\u0275i18nApply(1)}}function ln(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,23),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.deviceCount),e.\u0275\u0275i18nApply(1)}}function rn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,24),e.\u0275\u0275elementEnd())}function sn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,25),e.\u0275\u0275elementEnd())}function dn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",89),e.\u0275\u0275i18n(1,26),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.lrcMultiK),e.\u0275\u0275i18nApply(1)}}function cn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,27),e.\u0275\u0275elementEnd())}function On(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,28),e.\u0275\u0275elementEnd())}function mn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,29),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.deviceCount),e.\u0275\u0275i18nApply(1)}}function un(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,30),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.deviceCount),e.\u0275\u0275i18nApply(1)}}function En(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,32),e.\u0275\u0275elementEnd())}function pn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,33),e.\u0275\u0275elementEnd())}function fn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",96)(2,"span",67),e.\u0275\u0275i18n(3,31),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63),e.\u0275\u0275element(6,"input",97),e.\u0275\u0275template(7,En,2,0,"span",65)(8,pn,2,0,"span",65),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(7);e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.shec.c),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.form.showError("c",i,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.form.showError("c",i,"cGreaterM"))}}function Pn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",89),e.\u0275\u0275i18n(1,35),e.\u0275\u0275elementEnd())}function Cn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",89),e.\u0275\u0275i18n(1,36),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.getDMin())(n.getDMax()),e.\u0275\u0275i18nApply(1)}}function Rn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",89),e.\u0275\u0275i18n(1,37),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.getDMax()),e.\u0275\u0275i18nApply(1)}}function gn(o,t){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Cn,2,2,"span",74)(2,Rn,2,1,"span",74),e.\u0275\u0275elementContainerEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.getDMin()<n.getDMax()),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.getDMin()===n.getDMax())}}function Mn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,38),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.getDMin()),e.\u0275\u0275i18nApply(1)}}function Sn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,39),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.getDMax()),e.\u0275\u0275i18nApply(1)}}function hn(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",61)(1,"label",98)(2,"span",67),e.\u0275\u0275i18n(3,34),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63)(6,"div",99),e.\u0275\u0275element(7,"input",100),e.\u0275\u0275elementStart(8,"button",101),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(_.toggleDCalc())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(9,"svg",102),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,Pn,2,0,"span",74)(11,gn,3,2,"ng-container",103)(12,Mn,2,1,"span",65)(13,Sn,2,1,"span",65),e.\u0275\u0275elementEnd()()}if(2&o){const n=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(7);e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.clay.d),e.\u0275\u0275advance(5),e.\u0275\u0275property("cdsIcon",n.dCalc?n.icons.unlock:n.icons.lock)("size",n.icons.size16),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.dCalc),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!n.dCalc),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.form.showError("d",i,"dMin")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.form.showError("d",i,"dMax"))}}function Ln(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,42),e.\u0275\u0275elementEnd())}function Fn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,43),e.\u0275\u0275elementEnd())}function Tn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,44),e.\u0275\u0275elementEnd())}function Nn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",104)(2,"span",67),e.\u0275\u0275i18n(3,40),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63),e.\u0275\u0275element(6,"input",105),e.\u0275\u0275template(7,Ln,2,0,"span",65)(8,Fn,2,0,"span",65)(9,Tn,2,0,"span",65),e.\u0275\u0275elementStart(10,"span",89),e.\u0275\u0275i18n(11,41),e.\u0275\u0275elementEnd()()()),2&o){const n=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(7);e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.lrc.l),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.form.showError("l",i,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.form.showError("l",i,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.form.showError("l",i,"unequal")),e.\u0275\u0275advance(2),e.\u0275\u0275i18nExp(n.lrcGroups),e.\u0275\u0275i18nApply(11)}}function An(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",88),e.\u0275\u0275i18n(1,45),e.\u0275\u0275elementEnd())}function vn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate2(" ",n," ( ",i.failureDomains[n].length," ) ")}}function bn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,46),e.\u0275\u0275elementEnd())}function In(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,47),e.\u0275\u0275elementEnd())}function $n(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",88),e.\u0275\u0275i18n(1,49),e.\u0275\u0275elementEnd())}function Dn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",88),e.\u0275\u0275i18n(1,50),e.\u0275\u0275elementEnd())}function yn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate2(" ",n," ( ",i.failureDomains[n].length," ) ")}}function xn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",106),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275i18n(3,48),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63)(6,"select",107),e.\u0275\u0275template(7,$n,2,0,"option",70)(8,Dn,2,0,"option",70)(9,yn,2,3,"option",71),e.\u0275\u0275elementEnd()()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.lrc.crushLocality),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!n.failureDomains),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.failureDomainKeys.length>0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.failureDomainKeys)}}function Un(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Gn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",108),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275i18n(3,51),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63)(6,"select",109),e.\u0275\u0275template(7,Un,2,2,"option",71),e.\u0275\u0275elementEnd()()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.clay.scalar_mds),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pureFunction3(2,Ke,n.PLUGIN.JERASURE,n.PLUGIN.ISA,n.PLUGIN.SHEC))}}function zn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Hn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",110),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275i18n(3,52),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63)(6,"select",111),e.\u0275\u0275template(7,zn,2,2,"option",71),e.\u0275\u0275elementEnd()()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins[n.plugin].technique),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",n.techniques)}}function Xn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",94),e.\u0275\u0275i18n(1,54),e.\u0275\u0275elementEnd())}function Vn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",61)(1,"label",112),e.\u0275\u0275elementContainerStart(2),e.\u0275\u0275i18n(3,53),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(4,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",63),e.\u0275\u0275element(6,"input",113),e.\u0275\u0275template(7,Xn,2,0,"span",65),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext(),i=e.\u0275\u0275reference(7);e.\u0275\u0275advance(4),e.\u0275\u0275property("html",n.tooltips.plugins.jerasure.packetSize),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.form.showError("packetSize",i,"min"))}}function wn(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",88),e.\u0275\u0275i18n(1,55),e.\u0275\u0275elementEnd())}function kn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Bn(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",95),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}class Le extends F{constructor(t,n,i,_,s){super(),this.formBuilder=t,this.activeModal=n,this.taskWrapper=i,this.ecpService=_,this.actionLabels=s,this.submitAction=new e.EventEmitter,this.PLUGIN={LRC:"lrc",SHEC:"shec",CLAY:"clay",JERASURE:"jerasure",ISA:"isa"},this.plugin=this.PLUGIN.JERASURE,this.icons=I.FI,this.CrushFailureDomains=b,this.action=this.actionLabels.CREATE,this.resource=$localize`EC Profile`,this.createForm(),this.setJerasureDefaults()}createForm(){this.form=this.formBuilder.group({name:[null,[l.Validators.required,l.Validators.pattern("[A-Za-z0-9_-]+"),m.xQ.custom("uniqueName",t=>this.names&&-1!==this.names.indexOf(t))]],plugin:[this.PLUGIN.JERASURE,[l.Validators.required]],k:[4,[l.Validators.required,m.xQ.custom("max",()=>this.baseValueValidation(!0)),m.xQ.custom("unequal",t=>this.lrcDataValidation(t)),m.xQ.custom("kLowerM",t=>this.shecDataValidation(t))]],m:[2,[l.Validators.required,m.xQ.custom("max",()=>this.baseValueValidation())]],crushFailureDomain:"",crushNumFailureDomains:[0,m.xQ.requiredIf({crushOsdsPerFailureDomain:{op:"minValue",arg1:1}})],crushOsdsPerFailureDomain:[0,m.xQ.requiredIf({crushNumFailureDomains:{op:"minValue",arg1:1}})],crushRoot:null,crushDeviceClass:"",directory:"",technique:"reed_sol_van",packetSize:[2048],l:[3,[l.Validators.required,m.xQ.custom("unequal",t=>this.lrcLocalityValidation(t))]],crushLocality:"",c:[2,[l.Validators.required,m.xQ.custom("cGreaterM",t=>this.shecDurabilityValidation(t))]],d:[5,[l.Validators.required,m.xQ.custom("dMin",t=>this.dMinValidation(t)),m.xQ.custom("dMax",t=>this.dMaxValidation(t))]],scalar_mds:[this.PLUGIN.JERASURE,[l.Validators.required]]}),this.toggleDCalc(),this.form.get("k").valueChanges.subscribe(()=>this.updateValidityOnChange(["m","l","d"])),this.form.get("m").valueChanges.subscribe(()=>this.updateValidityOnChange(["k","l","c","d"])),this.form.get("l").valueChanges.subscribe(()=>this.updateValidityOnChange(["k","m"])),this.form.get("plugin").valueChanges.subscribe(t=>this.onPluginChange(t)),this.form.get("scalar_mds").valueChanges.subscribe(()=>this.setClayDefaultsForScalar())}baseValueValidation(t=!1){return this.validValidation(()=>(this.form.get("crushFailureDomain").value===b.Host?this.getKMSum()+1:this.getKMSum())>this.deviceCount&&this.form.getValue("k")>this.form.getValue("m")===t)}validValidation(t,n){return!((!this.form||n)&&this.plugin!==n)&&t()}getKMSum(){return this.form.getValue("k")+this.form.getValue("m")}lrcDataValidation(t){return this.validValidation(()=>{const n=this.form.getValue("m"),i=this.form.getValue("l"),_=t+n;return this.lrcMultiK=t/(_/i),t%(_/i)!=0},"lrc")}shecDataValidation(t){return this.validValidation(()=>this.form.getValue("m")>t,"shec")}lrcLocalityValidation(t){return this.validValidation(()=>{const n=this.getKMSum();return this.lrcGroups=t>0?n/t:0,t>0&&n%t!=0},"lrc")}shecDurabilityValidation(t){return this.validValidation(()=>{const n=this.form.getValue("m");return t>n},"shec")}dMinValidation(t){return this.validValidation(()=>this.getDMin()>t,"clay")}getDMin(){return this.form.getValue("k")+1}dMaxValidation(t){return this.validValidation(()=>t>this.getDMax(),"clay")}getDMax(){const t=this.form.getValue("m");return this.form.getValue("k")+t-1}toggleDCalc(){this.dCalc=!this.dCalc,this.form.get("d")[this.dCalc?"disable":"enable"](),this.calculateD()}calculateD(){this.plugin!==this.PLUGIN.CLAY||!this.dCalc||this.form.silentSet("d",this.getDMax())}updateValidityOnChange(t){t.forEach(n=>{"d"===n&&this.calculateD(),this.form.get(n).updateValueAndValidity({emitEvent:!1})})}onPluginChange(t){this.plugin=t,t===this.PLUGIN.JERASURE?this.setJerasureDefaults():t===this.PLUGIN.LRC?this.setLrcDefaults():t===this.PLUGIN.ISA?this.setIsaDefaults():t===this.PLUGIN.SHEC?this.setShecDefaults():t===this.PLUGIN.CLAY&&this.setClayDefaults(),this.updateValidityOnChange(["m"])}setJerasureDefaults(){this.techniques=["reed_sol_van","reed_sol_r6_op","cauchy_orig","cauchy_good","liberation","blaum_roth","liber8tion"],this.setDefaults({k:4,m:2,technique:"reed_sol_van"})}setLrcDefaults(){this.setDefaults({k:4,m:2,l:3})}setIsaDefaults(){this.techniques=["reed_sol_van","cauchy"],this.setDefaults({k:7,m:3,technique:"reed_sol_van"})}setShecDefaults(){this.setDefaults({k:4,m:3,c:2})}setClayDefaults(){this.setDefaults({k:4,m:2,scalar_mds:this.PLUGIN.JERASURE}),this.setClayDefaultsForScalar()}setClayDefaultsForScalar(){const t=this.form.getValue("scalar_mds");let n="reed_sol_van";t===this.PLUGIN.JERASURE?this.techniques=["reed_sol_van","reed_sol_r6_op","cauchy_orig","cauchy_good","liber8tion"]:t===this.PLUGIN.ISA?this.techniques=["reed_sol_van","cauchy"]:(n="single",this.techniques=["single","multiple"]),this.setDefaults({technique:n})}setDefaults(t){Object.keys(t).forEach(n=>{const i=this.form.get(n),_=i.value;i.pristine||"technique"===n&&!this.techniques.includes(_)||"k"===n&&[4,7].includes(_)||"m"===n&&[2,3].includes(_)?i.setValue(t[n]):i.updateValueAndValidity()})}ngOnInit(){this.tooltips=this.ecpService.formTooltips,this.ecpService.getInfo().subscribe(({plugins:t,names:n,directory:i,nodes:_})=>{this.initCrushNodeSelection(_,this.form.get("crushRoot"),this.form.get("crushFailureDomain"),this.form.get("crushDeviceClass"),!1),this.plugins=t,this.names=n,this.form.silentSet("directory",i),this.preValidateNumericInputFields()})}preValidateNumericInputFields(){const t=["k","m","l","c","d"].map(n=>this.form.get(n));t.forEach(n=>{n.markAsTouched(),n.markAsDirty()}),t[1].updateValueAndValidity()}onSubmit(){if(this.form.invalid)return void this.form.setErrors({cdSubmitButton:!0});const t=this.createJson();this.taskWrapper.wrapTaskAroundCall({task:new $.O("ecp/create",{name:t.name}),call:this.ecpService.create(t)}).subscribe({error:()=>{this.form.setErrors({cdSubmitButton:!0})},complete:()=>{this.activeModal.close(),this.submitAction.emit(t)}})}createJson(){const t={technique:[this.PLUGIN.ISA,this.PLUGIN.JERASURE,this.PLUGIN.CLAY],packetSize:[this.PLUGIN.JERASURE],l:[this.PLUGIN.LRC],crushLocality:[this.PLUGIN.LRC],c:[this.PLUGIN.SHEC],d:[this.PLUGIN.CLAY],scalar_mds:[this.PLUGIN.CLAY]},n=new Dt,i=this.form.getValue("plugin");return Object.keys(this.form.controls).filter(_=>{const s=t[_],d=this.form.getValue(_);return(s&&s.includes(i)||!s)&&d&&""!==d}).forEach(_=>{this.extendJson(_,n)}),n}extendJson(t,n){const _=this.form.getValue(t);n[{crushFailureDomain:"crush-failure-domain",crushNumFailureDomains:"crush-num-failure-domains",crushOsdsPerFailureDomain:"crush-osds-per-failure-domain",crushRoot:"crush-root",crushDeviceClass:"crush-device-class",packetSize:"packetsize",crushLocality:"crush-locality"}[t]||t]="crushRoot"===t?_.name:_}onCrushFailureDomainChane(){this.form.get("k").updateValueAndValidity(),this.form.get("m").updateValueAndValidity()}static{this.\u0275fac=function(n){return new(n||Le)(e.\u0275\u0275directiveInject(Qe.$),e.\u0275\u0275directiveInject(E.NgbActiveModal),e.\u0275\u0275directiveInject(Me.a),e.\u0275\u0275directiveInject(T),e.\u0275\u0275directiveInject(g.Ss))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Le,selectors:[["cd-erasure-code-profile-form-modal"]],outputs:{submitAction:"submitAction"},features:[e.\u0275\u0275InheritDefinitionFeature],decls:118,vars:59,consts:()=>{let t,n,i,_,s,d,O,u,P,M,S,C,R,L,f,x,U,G,z,H,X,V,w,k,B,j,q,Q,J,K,W,Y,Z,ee,te,ne,oe,ie,A,_e,ae,le,re,se,de,ce,Oe,me,ue,Ee,pe,fe,v,Pe,Ce,Re;return t=$localize`:form title␟fb127ea03835b3230f0ed981c7080e2ccb879621␟3346778808274133574:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,n=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,i=$localize`:␟ef9ff0e6227947b48dfab4ac39ade04af758913b␟4562362040556606648:Plugin`,_=$localize`:␟dd69b31bce8f630eac1d4762b0bbcf72ce19d193␟7955887200666997467:Data chunks (k)`,s=$localize`:␟dab3a299ead121169b8e08ed618c3b6a2f66691b␟1471879088759639523:Coding chunks (m)`,d=$localize`:␟d455a110bf6d2235e314e295ce1dfeee93d3dff2␟5489807080482456498:Crush failure domain`,O=$localize`:␟0b795eebfd4f579b320665418c2e4c01368c872d␟7909691702091350598:Crush num failure domain`,u=$localize`:␟d43b0debfb35f32526e569074682e020391c5f5c␟5506639649229572031:Crush osds per failure domain`,P=$localize`:␟c0252cd81ca54d0a2f69ec9ccf4248e73df5aa4a␟6046264436151872561:Crush root`,M=$localize`:␟1548d5c76f0406ddd1ba3c557e1e6db22e95b340␟2641000698188090134:Crush device class`,S=$localize`:␟74f31fc7133681cf2c20cfb9e350e2447cb7091e␟5916475565738124222:All devices`,C=$localize`:␟ae29e7393940afb8d883131bfbe7933ed163ec72␟819838447230333063:${"\ufffd0\ufffd"}:INTERPOLATION:`,R=$localize`:␟f3f657ffa19dc6ac504b83c86209709522dcf065␟6229695115677974088:Available OSDs: ${"\ufffd0\ufffd"}:INTERPOLATION:`,L=$localize`:␟03d84645f6e019c5a43909bbf2ea1696ee88332c␟5256256049865563765:Directory`,f=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,x=$localize`:␟490e15ecc922965b6d8194754c87c5583aa071f3␟1576206503438015503:The name can only consist of alphanumeric characters, dashes and underscores.`,U=$localize`:␟9edc2b494e660618af3e5225f68d40b7ca67629c␟1951556666035670157:The chosen erasure code profile name is already in use.`,G=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,z=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,H=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,X=$localize`:␟b0d26a6172d32cb81218fe2103c54a818cbc1189␟8474704684464173948:Must be equal to or greater than 2.`,V=$localize`:␟5ba6f4800642eba4e8b056aa7167554c3afa8db0␟3359836088137801733:Chunks (k+m) have exceeded the available OSDs of ${"\ufffd0\ufffd"}:INTERPOLATION:.`,w=$localize`:␟2e66a96375d9ec5017597e57663c8cde0cba4ee6␟8545367220209602031:Chunks (k+m+1) have exceeded the available hosts of ${"\ufffd0\ufffd"}:INTERPOLATION:.`,k=$localize`:␟86fca2f788ce986eef835cd7ef8dfc9ae22447a4␟3917858926503912155:For an equal distribution k has to be a multiple of (k+m)/l.`,B=$localize`:␟8dd4bc172f1adc4afadaec291e465b082909148d␟9208623611694278127:K has to be equal to or greater than m in order to recover data correctly through c.`,j=$localize`:␟f2e5b0e6d0dba31c59f946392699a0a6c4dd9b83␟2764950342107258730:Distribution factor: ${"\ufffd0\ufffd"}:INTERPOLATION:`,q=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,Q=$localize`:␟1e2773e5bd4948193f18f2361d663ecc3988c656␟5366066218193149651:Must be equal to or greater than 1.`,J=$localize`:␟5ba6f4800642eba4e8b056aa7167554c3afa8db0␟3359836088137801733:Chunks (k+m) have exceeded the available OSDs of ${"\ufffd0\ufffd"}:INTERPOLATION:.`,K=$localize`:␟2e66a96375d9ec5017597e57663c8cde0cba4ee6␟8545367220209602031:Chunks (k+m+1) have exceeded the available hosts of ${"\ufffd0\ufffd"}:INTERPOLATION:.`,W=$localize`:␟6cde4c945a49a260c0a47bcc7cd956846930a5f7␟1759957197988313421:Durability estimator (c)`,Y=$localize`:␟1e2773e5bd4948193f18f2361d663ecc3988c656␟5366066218193149651:Must be equal to or greater than 1.`,Z=$localize`:␟4ec9ff9931f8ea1201792d6a01bf9a47b283d692␟8961048959373432308:C has to be equal to or lower than m as m defines the amount of chunks that can be used.`,ee=$localize`:␟e0c250a8d281291273ed3504ade19ca6537e4d9a␟1704211354004450752:Set d manually or use the plugin's default calculation that maximizes d.`,te=$localize`:␟35594fe66657ea07b5b5f560927f78e81a229996␟2038593409574317326:Helper chunks (d)`,ne=$localize`:␟4304a5cd95742db0f81c3bdf29aa96bf3b0ca13d␟1888025761663541097:D is automatically updated on k and m changes`,oe=$localize`:␟06a67d52427b12df2b3d439be0e1342ac72aeb5c␟7955996980541003424:D can be set from ${"\ufffd0\ufffd"}:INTERPOLATION: to ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,ie=$localize`:␟d4f8831d3bd6401e87710c4e3ee844f5efbf5de3␟5777341828354086382:D can only be set to ${"\ufffd0\ufffd"}:INTERPOLATION:`,A=$localize`:␟f5d7aacffce2c6032c3ae9ef4d1b3847a926440b␟5713559827745087589:D has to be greater than k (${"\ufffd0\ufffd"}:INTERPOLATION:).`,_e=$localize`:␟fd745d614884edc23c7ac9ad8aba9655f3793ac2␟7286956565403634147:D has to be lower than k + m (${"\ufffd0\ufffd"}:INTERPOLATION:).`,ae=$localize`:␟af668c2a095a979ea2b4e43cd82c2120ab56c21c␟5810495024055124667:Locality (l)`,le=$localize`:␟319ac5d692d11da686782159bd70e0b705c228ed␟1697705454616708510:Locality groups: ${"\ufffd0\ufffd"}:INTERPOLATION:`,re=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,se=$localize`:␟1e2773e5bd4948193f18f2361d663ecc3988c656␟5366066218193149651:Must be equal to or greater than 1.`,de=$localize`:␟200fea08b63ae8d60cdbf33ffd2636159e87dc1e␟2767541069843337993:Can't split up chunks (k+m) correctly with the current locality.`,ce=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,Oe=$localize`:␟cd481effefabe6311c9f157dfe48cd231896a916␟6825543475279966029:This field is required when crush osds per failure domain is set!`,me=$localize`:␟4c52a310ca62168e2779a435fe764b498927eaf1␟4898738149365434916:This field is required when crush num failure domain is set!`,ue=$localize`:␟b74a495f041f7dd102eee5c0bbc9e03083b538ae␟4728165402618807403:Crush Locality`,Ee=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,pe=$localize`:␟a2f14a73f7a6e94479f67423cc51102da8d6f524␟6252070156626006029:None`,fe=$localize`:␟363a99d62822b92913a4cce196d47f32c1258e2f␟236060313699362274:Scalar mds`,v=$localize`:␟2981733b912b693a9dd9d915d6d34f4692cc874a␟3248445660509657942:Technique`,Pe=$localize`:␟e0098b6e47b04ec817361f384ce81d454ba5c0bb␟8649008147509815275:Packetsize`,Ce=$localize`:␟1e2773e5bd4948193f18f2361d663ecc3988c656␟5366066218193149651:Must be equal to or greater than 1.`,Re=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,[["frm","ngForm"],t,n,i,_,s,d,O,u,P,M,S,C,R,L,f,x,U,G,z,H,X,V,w,k,B,j,q,Q,J,K,W,Y,Z,te,ne,oe,ie,A,_e,ae,le,re,se,de,ce,Oe,me,ue,Ee,pe,fe,v,Pe,Ce,Re,[3,"modalRef"],[1,"modal-title"],[1,"modal-content"],["novalidate","",3,"formGroup"],[1,"modal-body"],[1,"form-group","row"],["for","name",1,"cd-col-form-label"],[1,"cd-col-form-input"],["type","text","id","name","name","name","placeholder","Name...","formControlName","name","autofocus","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","plugin",1,"cd-col-form-label"],[1,"required"],[3,"html"],["id","plugin","name","plugin","formControlName","plugin",1,"form-select"],["ngValue","",4,"ngIf"],[3,"ngValue",4,"ngFor","ngForOf"],["for","k",1,"cd-col-form-label"],["type","number","id","k","name","k","ng-model","$ctrl.erasureCodeProfile.k","placeholder","Data chunks...","formControlName","k","min","2",1,"form-control"],["class","form-text text-muted",4,"ngIf"],["for","m",1,"cd-col-form-label"],["type","number","id","m","name","m","placeholder","Coding chunks...","formControlName","m","min","1",1,"form-control"],["class","form-group row",4,"ngIf"],["for","crushFailureDomain",1,"cd-col-form-label"],["id","crushFailureDomain","name","crushFailureDomain","formControlName","crushFailureDomain",1,"form-select",3,"change"],["for","crushNumFailureDomains",1,"cd-col-form-label"],["type","number","id","crushNumFailureDomains","name","crushNumFailureDomains","formControlName","crushNumFailureDomains","min","0",1,"form-control"],["for","crushOsdsPerFailureDomain",1,"cd-col-form-label"],["type","number","id","crushOsdsPerFailureDomain","name","crushOsdsPerFailureDomain","formControlName","crushOsdsPerFailureDomain","min","0",1,"form-control"],["for","crushRoot",1,"cd-col-form-label"],["id","crushRoot","name","crushRoot","formControlName","crushRoot",1,"form-select"],["for","crushDeviceClass",1,"cd-col-form-label"],["id","crushDeviceClass","name","crushDeviceClass","formControlName","crushDeviceClass",1,"form-select"],["ngValue",""],[1,"form-text","text-muted"],["for","directory",1,"cd-col-form-label"],["type","text","id","directory","name","directory","placeholder","Path...","formControlName","directory",1,"form-control"],[1,"modal-footer"],[3,"submitActionEvent","form","submitText"],[1,"invalid-feedback"],[3,"ngValue"],["for","c",1,"cd-col-form-label"],["type","number","id","c","name","c","placeholder","Coding chunks...","formControlName","c","min","1",1,"form-control"],["for","d",1,"cd-col-form-label"],[1,"input-group"],["type","number","id","d","name","d","placeholder","Helper chunks...","formControlName","d",1,"form-control"],["id","d-calc-btn","ngbTooltip",ee,"type","button",1,"btn","btn-light",3,"click"],[1,"cds-info-color",3,"cdsIcon","size"],[4,"ngIf"],["for","l",1,"cd-col-form-label"],["type","number","id","l","name","l","placeholder","Coding chunks...","formControlName","l","min","1",1,"form-control"],["for","crushLocality",1,"cd-col-form-label"],["id","crushLocality","name","crushLocality","formControlName","crushLocality",1,"form-select"],["for","scalar_mds",1,"cd-col-form-label"],["id","scalar_mds","name","scalar_mds","formControlName","scalar_mds",1,"form-select"],["for","technique",1,"cd-col-form-label"],["id","technique","name","technique","formControlName","technique",1,"form-select"],["for","packetSize",1,"cd-col-form-label"],["type","number","id","packetSize","name","packetSize","placeholder","Packetsize...","formControlName","packetSize","min","1",1,"form-control"]]},template:function(n,i){if(1&n){const _=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cd-modal",56),e.\u0275\u0275elementContainerStart(1,57),e.\u0275\u0275i18n(2,1),e.\u0275\u0275pipe(3,"titlecase"),e.\u0275\u0275pipe(4,"upperFirst"),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(5,58),e.\u0275\u0275elementStart(6,"form",59,0)(8,"div",60)(9,"div",61)(10,"label",62),e.\u0275\u0275i18n(11,2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",63),e.\u0275\u0275element(13,"input",64),e.\u0275\u0275template(14,Wt,2,0,"span",65)(15,Yt,2,0,"span",65)(16,Zt,2,0,"span",65),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"div",61)(18,"label",66)(19,"span",67),e.\u0275\u0275i18n(20,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",63)(23,"select",69),e.\u0275\u0275template(24,en,2,0,"option",70)(25,tn,2,2,"option",71),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(26,nn,2,0,"span",65),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"div",61)(28,"label",72)(29,"span",67),e.\u0275\u0275i18n(30,4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(31,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"div",63),e.\u0275\u0275element(33,"input",73),e.\u0275\u0275template(34,on,2,0,"span",65)(35,_n,2,0,"span",65)(36,an,2,1,"span",65)(37,ln,2,1,"span",65)(38,rn,2,0,"span",65)(39,sn,2,0,"span",65)(40,dn,2,1,"span",74),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(41,"div",61)(42,"label",75)(43,"span",67),e.\u0275\u0275i18n(44,5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"div",63),e.\u0275\u0275element(47,"input",76),e.\u0275\u0275template(48,cn,2,0,"span",65)(49,On,2,0,"span",65)(50,mn,2,1,"span",65)(51,un,2,1,"span",65),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(52,fn,9,3,"div",77)(53,hn,14,7,"div",77)(54,Nn,12,5,"div",77),e.\u0275\u0275elementStart(55,"div",61)(56,"label",78),e.\u0275\u0275elementContainerStart(57),e.\u0275\u0275i18n(58,6),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(59,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(60,"div",63)(61,"select",79),e.\u0275\u0275listener("change",function(){return e.\u0275\u0275restoreView(_),e.\u0275\u0275resetView(i.onCrushFailureDomainChane())}),e.\u0275\u0275template(62,An,2,0,"option",70)(63,vn,2,3,"option",71),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(64,"div",61)(65,"label",80),e.\u0275\u0275elementContainerStart(66),e.\u0275\u0275i18n(67,7),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(68,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(69,"div",63),e.\u0275\u0275element(70,"input",81),e.\u0275\u0275template(71,bn,2,0,"span",65),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(72,"div",61)(73,"label",82),e.\u0275\u0275elementContainerStart(74),e.\u0275\u0275i18n(75,8),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(76,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(77,"div",63),e.\u0275\u0275element(78,"input",83),e.\u0275\u0275template(79,In,2,0,"span",65),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(80,xn,10,4,"div",77)(81,Gn,8,6,"div",77)(82,Hn,8,2,"div",77)(83,Vn,8,2,"div",77),e.\u0275\u0275elementStart(84,"div",61)(85,"label",84),e.\u0275\u0275elementContainerStart(86),e.\u0275\u0275i18n(87,9),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(88,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(89,"div",63)(90,"select",85),e.\u0275\u0275template(91,wn,2,0,"option",70)(92,kn,2,2,"option",71),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(93,"div",61)(94,"label",86),e.\u0275\u0275elementContainerStart(95),e.\u0275\u0275i18n(96,10),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(97,"div",63)(98,"select",87)(99,"option",88),e.\u0275\u0275i18n(100,11),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(101,Bn,2,2,"option",71),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(102,"cd-help-text")(103,"span"),e.\u0275\u0275i18n(104,12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(105,"span",89),e.\u0275\u0275i18n(106,13),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(107,"div",61)(108,"label",90),e.\u0275\u0275elementContainerStart(109),e.\u0275\u0275i18n(110,14),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275element(111,"cd-helper",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(112,"div",63),e.\u0275\u0275element(113,"input",91),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(114,"div",92)(115,"cd-form-button-panel",93),e.\u0275\u0275pipe(116,"titlecase"),e.\u0275\u0275pipe(117,"upperFirst"),e.\u0275\u0275listener("submitActionEvent",function(){return e.\u0275\u0275restoreView(_),e.\u0275\u0275resetView(i.onSubmit())}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()}if(2&n){const _=e.\u0275\u0275reference(7);e.\u0275\u0275property("modalRef",i.activeModal),e.\u0275\u0275advance(4),e.\u0275\u0275i18nExp(e.\u0275\u0275pipeBind1(3,47,i.action))(e.\u0275\u0275pipeBind1(4,49,i.resource)),e.\u0275\u0275i18nApply(2),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",i.form),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"pattern")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"uniqueName")),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.plugins[i.plugin].description),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!i.plugins),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.plugins),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",_,"required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.k),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"max")&&i.form.getValue("crushFailureDomain")===i.CrushFailureDomains.Osd),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"max")&&i.form.getValue("crushFailureDomain")===i.CrushFailureDomains.Host),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"unequal")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("k",_,"kLowerM")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","lrc"===i.plugin),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.m),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.form.showError("m",_,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("m",_,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("m",_,"max")&&i.form.getValue("crushFailureDomain")===i.CrushFailureDomains.Osd),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("m",_,"max")&&i.form.getValue("crushFailureDomain")===i.CrushFailureDomains.Host),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","shec"===i.plugin),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","clay"===i.plugin),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.plugin===i.PLUGIN.LRC),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.crushFailureDomain),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!i.failureDomains),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.failureDomainKeys),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.crushNumFailureDomains),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.form.showError("crushNumFailureDomains",_,"required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.crushOsdsPerFailureDomain),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.form.showError("crushOsdsPerFailureDomain",_,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.plugin===i.PLUGIN.LRC),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.PLUGIN.CLAY===i.plugin),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",e.\u0275\u0275pureFunction3(55,Ke,i.PLUGIN.JERASURE,i.PLUGIN.ISA,i.PLUGIN.CLAY).includes(i.plugin)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.plugin===i.PLUGIN.JERASURE),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.crushRoot),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!i.buckets),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.buckets),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngForOf",i.devices),e.\u0275\u0275advance(3),e.\u0275\u0275i18nExp(i.tooltips.crushDeviceClass),e.\u0275\u0275i18nApply(104),e.\u0275\u0275advance(2),e.\u0275\u0275i18nExp(i.deviceCount),e.\u0275\u0275i18nApply(106),e.\u0275\u0275advance(5),e.\u0275\u0275property("html",i.tooltips.directory),e.\u0275\u0275advance(4),e.\u0275\u0275property("form",i.form)("submitText",e.\u0275\u0275pipeBind1(116,51,i.action)+" "+e.\u0275\u0275pipeBind1(117,53,i.resource))}},dependencies:[h.NgForOf,h.NgIf,ve.m,Je.z,be.e,Ie.O,$e.B,De.S,ye.a,xe.C,Ue.E,l.\u0275NgNoValidate,l.NgSelectOption,l.\u0275NgSelectMultipleOption,l.DefaultValueAccessor,l.NumberValueAccessor,l.SelectControlValueAccessor,l.NgControlStatus,l.NgControlStatusGroup,l.MinValidator,l.FormGroupDirective,l.FormControlName,E.NgbTooltip,he.IconDirective,h.TitleCasePipe,Ge.r]})}}var jn=r(66668);class qn{constructor(){this.erasureInfo=!1,this.crushInfo=!1,this.APP_LABELS={cephfs:"Filesystem",rbd:"Block",rgw:"Object"},this.pgs=1,this.poolTypes=["erasure","replicated"],this.applications={selected:[],default:["cephfs","rbd","rgw"],available:[],validators:[l.Validators.pattern("[A-Za-z0-9_]+"),l.Validators.maxLength(128)],messages:new jn.z({empty:$localize`No applications added`,selectionLimit:{text:$localize`Applications limit reached`,tooltip:$localize`A pool can only have up to four applications definitions.`},customValidations:{pattern:$localize`Allowed characters '_a-zA-Z0-9'`,maxlength:$localize`Maximum length is 128 characters`},filter:$localize`Filter or add applications`,add:$localize`Add application`})}}}var Qn=r(6872),Jn=r(48693),Kn=r(87837),We=r(37823),Wn=r(56677),Yn=r(45413);const Zn=["crushInfoTabs"],eo=["crushDeletionBtn"],to=["ecpInfoTabs"],no=["ecpDeletionBtn"],Ye=o=>({active:o}),oo=()=>["name"],io=()=>["steps","type","rule_name"];function _o(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,22),e.\u0275\u0275elementEnd())}function ao(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,23),e.\u0275\u0275elementEnd())}function lo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,24),e.\u0275\u0275elementEnd())}function ro(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,25),e.\u0275\u0275elementEnd())}function so(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function co(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,26),e.\u0275\u0275elementEnd())}function Oo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function mo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,29),e.\u0275\u0275elementEnd())}function uo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,30),e.\u0275\u0275elementEnd())}function Eo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,31),e.\u0275\u0275elementEnd())}function po(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",121),e.\u0275\u0275i18n(1,32),e.\u0275\u0275elementEnd())}function fo(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",90)(1,"label",119),e.\u0275\u0275i18n(2,28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92)(4,"input",120),e.\u0275\u0275listener("focus",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(_.externalPgChange=!1)})("blur",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(_.alignPgs())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,mo,2,0,"span",94)(6,uo,2,0,"span",94)(7,Eo,2,0,"span",94),e.\u0275\u0275elementStart(8,"span",121),e.\u0275\u0275element(9,"cd-doc",122),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,po,2,0,"span",123),e.\u0275\u0275elementEnd()()}if(2&o){e.\u0275\u0275nextContext(2);const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",i.form.showError("pgNum",n,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("pgNum",n,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("pgNum",n,"34")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",i.externalPgChange)}}function Po(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",115)(1,"ul",127)(2,"li"),e.\u0275\u0275i18n(3,34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"li"),e.\u0275\u0275i18n(5,35),e.\u0275\u0275elementEnd()()()),2&o){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(3),e.\u0275\u0275i18nExp(n.getMinSize()),e.\u0275\u0275i18nApply(3),e.\u0275\u0275advance(2),e.\u0275\u0275i18nExp(n.getMaxSize()),e.\u0275\u0275i18nApply(5)}}function Co(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,36),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(),e.\u0275\u0275i18nExp(n.getMinSize())(n.getMaxSize()),e.\u0275\u0275i18nApply(1)}}function Ro(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",128),e.\u0275\u0275i18n(1,37),e.\u0275\u0275elementEnd())}function go(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",90)(1,"label",124),e.\u0275\u0275i18n(2,33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92),e.\u0275\u0275element(4,"input",125),e.\u0275\u0275template(5,Po,6,2,"span",94)(6,Co,2,2,"span",94)(7,Ro,2,0,"span",126),e.\u0275\u0275elementEnd()()),2&o){e.\u0275\u0275nextContext(2);const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("max",i.getMaxSize())("min",i.getMinSize()),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("size",n)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("size",n)),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",1===i.form.getValue("size"))}}function Mo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"div",90)(1,"label",129),e.\u0275\u0275i18n(2,38),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92)(4,"div",130),e.\u0275\u0275element(5,"input",131),e.\u0275\u0275elementStart(6,"label",132),e.\u0275\u0275i18n(7,39),e.\u0275\u0275elementEnd()()()())}function So(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"div",90)(2,"label",117),e.\u0275\u0275i18n(3,27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",92)(5,"select",118),e.\u0275\u0275template(6,Oo,2,2,"option",98),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,fo,11,4,"div",103)(8,go,8,5,"div",103)(9,Mo,8,0,"div",103),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",n.pgAutoscaleModes),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","on"!==n.form.getValue("pgAutoscaleMode")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isReplicated),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.info.is_all_bluestore&&n.isErasure)}}function ho(o,t){if(1&o&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(0,"svg",133)),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("cdsIcon",n.icons.warning)("size",n.icons.size20)}}function Lo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,40),e.\u0275\u0275elementEnd())}function Fo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"div",90)(1,"div",134)(2,"div",130),e.\u0275\u0275element(3,"input",135),e.\u0275\u0275elementStart(4,"label",136),e.\u0275\u0275i18n(5,41),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"cd-help-text")(7,"span"),e.\u0275\u0275i18n(8,42),e.\u0275\u0275elementEnd()()()()())}function To(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",97),e.\u0275\u0275i18n(1,45),e.\u0275\u0275elementEnd())}function No(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",147),e.\u0275\u0275i18n(1,46),e.\u0275\u0275elementEnd()),2&o&&e.\u0275\u0275property("ngValue",null)}function Ao(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",147),e.\u0275\u0275i18n(1,47),e.\u0275\u0275elementEnd()),2&o&&e.\u0275\u0275property("ngValue",null)}function vo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",147),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.name," ")}}function bo(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",148),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(_.addErasureCodeProfile())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(1,"svg",143),e.\u0275\u0275elementEnd()}if(2&o){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(),e.\u0275\u0275property("cdsIcon",n.icons.add)("size",n.icons.size20)}}function Io(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",149,1),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(_.deleteErasureCodeProfile())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(2,"svg",143),e.\u0275\u0275elementEnd()}if(2&o){const n=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(2),e.\u0275\u0275property("cdsIcon",n.icons.trash)("size",n.icons.size16)}}function $o(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-table-key-value",157),2&o){const n=e.\u0275\u0275nextContext(5);e.\u0275\u0275property("renderObjects",!0)("hideKeys",e.\u0275\u0275pureFunction0(4,oo))("data",n.form.getValue("erasureProfile"))("autoReload",!1)}}function Do(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,50),e.\u0275\u0275elementEnd())}function yo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"li"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function xo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"ul"),e.\u0275\u0275template(1,yo,2,1,"li",159),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.ecpUsage)}}function Uo(o,t){if(1&o&&e.\u0275\u0275template(0,Do,2,0,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)(2,xo,2,1,"ul",158),2&o){const n=e.\u0275\u0275reference(1),i=e.\u0275\u0275nextContext(5);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.ecpUsage)("ngIfElse",n)}}function Go(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"span",150)(1,"nav",151,2),e.\u0275\u0275elementContainerStart(3,152),e.\u0275\u0275elementStart(4,"a",153),e.\u0275\u0275i18n(5,48),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,$o,1,5,"ng-template",154),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(7,155),e.\u0275\u0275elementStart(8,"a",153),e.\u0275\u0275i18n(9,49),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Uo,3,2,"ng-template",154),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"div",156),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275reference(2);e.\u0275\u0275advance(11),e.\u0275\u0275property("ngbNavOutlet",n)}}function zo(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",90)(1,"label",137),e.\u0275\u0275i18n(2,44),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92)(4,"div",106)(5,"select",138),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(_.erasureProfileChange())}),e.\u0275\u0275template(6,To,2,0,"option",139)(7,No,2,1,"option",140)(8,Ao,2,1,"option",140)(9,vo,2,2,"option",141),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"button",142),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(_.data.erasureInfo=!_.data.erasureInfo)}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(11,"svg",143),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,bo,2,2,"button",144)(13,Io,3,2,"button",145),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,Go,12,1,"span",146),e.\u0275\u0275elementEnd()()}if(2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",!n.ecProfiles),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.ecProfiles&&0===n.ecProfiles.length),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.ecProfiles&&n.ecProfiles.length>0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.ecProfiles),e.\u0275\u0275advance(),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(10,Ye,n.data.erasureInfo)),e.\u0275\u0275advance(),e.\u0275\u0275property("cdsIcon",n.icons.questionCircle)("size",n.icons.size20),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!n.editing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!n.editing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.data.erasureInfo&&n.form.getValue("erasureProfile"))}}function Ho(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",121),e.\u0275\u0275i18n(1,52),e.\u0275\u0275elementEnd())}function Xo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",121),e.\u0275\u0275i18n(1,53),e.\u0275\u0275elementEnd())}function Vo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",90)(1,"label",160),e.\u0275\u0275i18n(2,51),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92),e.\u0275\u0275template(4,Ho,2,0,"span",161)(5,Xo,2,0,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275reference(6),i=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!i.msrCrush)("ngIfElse",n)}}function wo(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",121)(1,"span"),e.\u0275\u0275i18n(2,55),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3,"\xa0 "),e.\u0275\u0275elementEnd())}function ko(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",147),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("ngValue",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n.rule_name," ")}}function Bo(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",148),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(_.addCrushRule())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(1,"svg",143),e.\u0275\u0275elementEnd()}if(2&o){const n=e.\u0275\u0275nextContext(5);e.\u0275\u0275advance(),e.\u0275\u0275property("cdsIcon",n.icons.add)("size",n.icons.size16)}}function jo(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",167,6),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(5);return e.\u0275\u0275resetView(_.deleteCrushRule())}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(2,"svg",143),e.\u0275\u0275elementEnd()}if(2&o){const n=e.\u0275\u0275nextContext(5);e.\u0275\u0275advance(2),e.\u0275\u0275property("cdsIcon",n.icons.trash)("size",n.icons.size16)}}function qo(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-table-key-value",157),2&o){const n=e.\u0275\u0275nextContext(6);e.\u0275\u0275property("renderObjects",!1)("hideKeys",e.\u0275\u0275pureFunction0(4,io))("data",n.form.getValue("crushRule"))("autoReload",!1)}}function Qo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"li"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit,i=e.\u0275\u0275nextContext(7);e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",i.describeCrushStep(n)," ")}}function Jo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"ol"),e.\u0275\u0275template(1,Qo,2,1,"li",159),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.form.get("crushRule").value.steps)}}function Ko(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,60),e.\u0275\u0275elementEnd())}function Wo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"li"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Yo(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"ul"),e.\u0275\u0275template(1,Wo,2,1,"li",159),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(7);e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",n.crushUsage)}}function Zo(o,t){if(1&o&&e.\u0275\u0275template(0,Ko,2,0,"ng-template",null,8,e.\u0275\u0275templateRefExtractor)(2,Yo,2,1,"ul",158),2&o){const n=e.\u0275\u0275reference(1),i=e.\u0275\u0275nextContext(6);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.crushUsage)("ngIfElse",n)}}function ei(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",168)(1,"nav",151,7),e.\u0275\u0275elementContainerStart(3,169),e.\u0275\u0275elementStart(4,"a",153),e.\u0275\u0275i18n(5,57),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,qo,1,5,"ng-template",154),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(7,170),e.\u0275\u0275elementStart(8,"a",153),e.\u0275\u0275i18n(9,58),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Jo,2,1,"ng-template",154),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(11,155),e.\u0275\u0275elementStart(12,"a",153),e.\u0275\u0275i18n(13,59),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,Zo,3,2,"ng-template",154),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(15,"div",156),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275reference(2);e.\u0275\u0275advance(15),e.\u0275\u0275property("ngbNavOutlet",n)}}function ti(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,61),e.\u0275\u0275elementEnd())}function ni(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,62),e.\u0275\u0275elementEnd())}function oi(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",162)(2,"select",163)(3,"option",147),e.\u0275\u0275i18n(4,56),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,ko,2,2,"option",141),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",164),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(_.data.crushInfo=!_.data.crushInfo)}),e.\u0275\u0275namespaceSVG(),e.\u0275\u0275element(7,"svg",143),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Bo,2,2,"button",144)(9,jo,3,2,"button",165),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,ei,16,1,"div",166)(11,ti,2,0,"span",94)(12,ni,2,0,"span",94),e.\u0275\u0275elementEnd()}if(2&o){e.\u0275\u0275nextContext(3);const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngValue",null),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.current.rules),e.\u0275\u0275advance(),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(10,Ye,i.data.crushInfo)),e.\u0275\u0275advance(),e.\u0275\u0275property("cdsIcon",i.icons.questionCircle)("size",i.icons.size20),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.isReplicated&&!i.editing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.isReplicated&&!i.editing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.data.crushInfo&&i.form.getValue("crushRule")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("crushRule",n,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("crushRule",n,"tooFewOsds"))}}function ii(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",90)(1,"label",160),e.\u0275\u0275i18n(2,54),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",92),e.\u0275\u0275template(4,wo,4,0,"ng-template",null,5,e.\u0275\u0275templateRefExtractor)(6,oi,13,12,"div",158),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",i.current.rules.length>0)("ngIfElse",n)}}function _i(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"legend"),e.\u0275\u0275i18n(2,43),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,zo,15,12,"div",103)(4,Vo,7,2,"div",103)(5,ii,7,2,"div",103),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.isErasure),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isErasure&&!n.editing),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",n.isReplicated||n.editing)}}function ai(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function li(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",97),e.\u0275\u0275i18n(1,73),e.\u0275\u0275elementEnd())}function ri(o,t){1&o&&(e.\u0275\u0275elementStart(0,"option",97),e.\u0275\u0275i18n(1,74),e.\u0275\u0275elementEnd())}function si(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function di(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function ci(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,75),e.\u0275\u0275elementEnd())}function Oi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,76),e.\u0275\u0275elementEnd())}function mi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,77),e.\u0275\u0275elementEnd())}function ui(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Ei(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,78),e.\u0275\u0275elementEnd())}function pi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,79),e.\u0275\u0275elementEnd())}function fi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,80),e.\u0275\u0275elementEnd())}function Pi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,81),e.\u0275\u0275elementEnd())}function Ci(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"div",90)(2,"label",174),e.\u0275\u0275elementContainerStart(3),e.\u0275\u0275i18n(4,65),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",92)(6,"select",175),e.\u0275\u0275template(7,li,2,0,"option",139)(8,ri,2,0,"option",139)(9,si,2,2,"option",98),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"cd-help-text")(11,"span"),e.\u0275\u0275i18n(12,66),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(13,"div",90)(14,"label",176),e.\u0275\u0275elementContainerStart(15),e.\u0275\u0275i18n(16,67),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",92)(18,"div",106),e.\u0275\u0275element(19,"input",177),e.\u0275\u0275elementStart(20,"select",178),e.\u0275\u0275template(21,di,2,2,"option",98),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"cd-help-text")(23,"span"),e.\u0275\u0275i18n(24,68),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(25,ci,2,0,"span",94)(26,Oi,2,0,"span",94)(27,mi,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"div",90)(29,"label",179),e.\u0275\u0275elementContainerStart(30),e.\u0275\u0275i18n(31,69),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"div",92)(33,"div",106),e.\u0275\u0275element(34,"input",180),e.\u0275\u0275elementStart(35,"select",181),e.\u0275\u0275template(36,ui,2,2,"option",98),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(37,"cd-help-text")(38,"span"),e.\u0275\u0275i18n(39,70),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(40,Ei,2,0,"span",94)(41,pi,2,0,"span",94)(42,fi,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(43,"div",90)(44,"label",182),e.\u0275\u0275elementContainerStart(45),e.\u0275\u0275i18n(46,71),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(47,"div",92),e.\u0275\u0275element(48,"input",183),e.\u0275\u0275elementStart(49,"cd-help-text")(50,"span"),e.\u0275\u0275i18n(51,72),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(52,Pi,2,0,"span",94),e.\u0275\u0275elementEnd()()()),2&o){e.\u0275\u0275nextContext(2);const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",!i.info.compression_algorithms),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.info.compression_algorithms&&0===i.info.compression_algorithms.length),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",i.info.compression_algorithms),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngForOf",i.blobUnits),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",i.form.showError("minBlobSize",n,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("minBlobSize",n,"maximum")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("minBlobSize",n,"pattern")),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngForOf",i.blobUnits),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",i.form.showError("maxBlobSize",n,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("maxBlobSize",n,"minimum")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("maxBlobSize",n,"pattern")),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",i.form.showError("ratio",n,"min")||i.form.showError("ratio",n,"max"))}}function Ri(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div",171)(1,"legend"),e.\u0275\u0275i18n(2,63),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",90)(4,"label",172),e.\u0275\u0275i18n(5,64),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",92)(7,"select",173),e.\u0275\u0275template(8,ai,2,2,"option",98),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"cd-help-text"),e.\u0275\u0275text(10,"Policy used for compression algorithm"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(11,Ci,53,12,"div",99),e.\u0275\u0275elementEnd()),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",n.info.compression_modes),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.hasCompressionEnabled())}}function gi(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"option",116),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&o){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate1(" ",n," ")}}function Mi(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,82),e.\u0275\u0275elementEnd())}function Si(o,t){1&o&&(e.\u0275\u0275elementStart(0,"span",115),e.\u0275\u0275i18n(1,83),e.\u0275\u0275elementEnd())}function hi(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",85)(1,"form",86,0)(3,"div",87)(4,"div",88),e.\u0275\u0275i18n(5,9),e.\u0275\u0275pipe(6,"titlecase"),e.\u0275\u0275pipe(7,"upperFirst"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",89)(9,"div",90)(10,"label",91),e.\u0275\u0275i18n(11,10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",92),e.\u0275\u0275element(13,"input",93),e.\u0275\u0275template(14,_o,2,0,"span",94)(15,ao,2,0,"span",94)(16,lo,2,0,"span",94)(17,ro,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"div",90)(19,"label",95),e.\u0275\u0275i18n(20,11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",92)(22,"select",96)(23,"option",97),e.\u0275\u0275i18n(24,12),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,so,2,2,"option",98),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(26,co,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(27,So,10,4,"div",99),e.\u0275\u0275elementStart(28,"div",90)(29,"label",100),e.\u0275\u0275elementContainerStart(30),e.\u0275\u0275i18n(31,13),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(32,"cd-helper")(33,"span"),e.\u0275\u0275i18n(34,14),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(35,"div",92)(36,"cd-select-badges",101),e.\u0275\u0275listener("selection",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(_.appSelection())}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(37,ho,1,2,"svg",102)(38,Lo,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(39,Fo,9,0,"div",103)(40,_i,6,3,"div",99)(41,Ri,12,2,"div",104),e.\u0275\u0275elementStart(42,"div")(43,"legend"),e.\u0275\u0275i18n(44,15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"div",90)(46,"label",105),e.\u0275\u0275elementContainerStart(47),e.\u0275\u0275i18n(48,16),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"div",92)(50,"div",106),e.\u0275\u0275element(51,"input",107),e.\u0275\u0275elementStart(52,"select",108),e.\u0275\u0275template(53,gi,2,2,"option",98),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(54,"cd-help-text")(55,"span"),e.\u0275\u0275i18n(56,17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(57,"br"),e.\u0275\u0275elementStart(58,"span"),e.\u0275\u0275i18n(59,18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(60,Mi,2,0,"span",94),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(61,"div",90)(62,"label",109),e.\u0275\u0275elementContainerStart(63),e.\u0275\u0275i18n(64,19),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(65,"div",92),e.\u0275\u0275element(66,"input",110),e.\u0275\u0275elementStart(67,"cd-help-text")(68,"span"),e.\u0275\u0275i18n(69,20),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(70,"br"),e.\u0275\u0275elementStart(71,"span"),e.\u0275\u0275i18n(72,21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(73,Si,2,0,"span",94),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(74,"div",111)(75,"cd-rbd-configuration-form",112),e.\u0275\u0275listener("changes",function(_){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.currentConfigurationValues=_())}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(76,"div",113)(77,"cd-form-button-panel",114),e.\u0275\u0275pipe(78,"titlecase"),e.\u0275\u0275pipe(79,"upperFirst"),e.\u0275\u0275listener("submitActionEvent",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(_.submit())}),e.\u0275\u0275elementEnd()()()()()}if(2&o){const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("formGroup",i.form),e.\u0275\u0275advance(6),e.\u0275\u0275i18nExp(e.\u0275\u0275pipeBind1(6,29,i.action))(e.\u0275\u0275pipeBind1(7,31,i.resource)),e.\u0275\u0275i18nApply(5),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",i.form.showError("name",n,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",n,"uniqueName")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",n,"rbdPool")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("name",n,"pattern")),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",i.data.poolTypes),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.form.showError("poolType",n,"required")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.isReplicated||i.isErasure),e.\u0275\u0275advance(9),e.\u0275\u0275property("customBadges",!0)("customBadgeValidators",i.data.applications.validators)("messages",i.data.applications.messages)("data",i.data.applications.selected)("options",i.data.applications.available)("selectionLimit",4),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.data.applications.selected<=0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",!i.isApplicationsSelected&&i.data.applications.selected<=0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.data.applications.selected.includes("rbd")),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.isErasure||i.isReplicated),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",i.info.is_all_bluestore),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngForOf",i.maxBytesUnits),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",i.form.showError("max_bytes",n,"pattern")),e.\u0275\u0275advance(13),e.\u0275\u0275property("ngIf",i.form.showError("max_objects",n,"min")),e.\u0275\u0275advance(),e.\u0275\u0275property("hidden",i.isErasure||-1===i.data.applications.selected.indexOf("rbd")),e.\u0275\u0275advance(),e.\u0275\u0275property("form",i.form)("initializeData",i.initializeConfigData),e.\u0275\u0275advance(2),e.\u0275\u0275property("form",i.form)("submitText",e.\u0275\u0275pipeBind1(78,33,i.action)+" "+e.\u0275\u0275pipeBind1(79,35,i.resource))}}class D extends xt.g{constructor(t,n,i,_,s,d,O,u,P,M,S,C){super(),this.dimlessBinaryPipe=t,this.route=n,this.router=i,this.modalService=_,this.poolService=s,this.authStorageService=d,this.formatter=O,this.taskWrapper=u,this.ecpService=P,this.crushRuleService=M,this.actionLabels=S,this.rbdMirroringService=C,this.editing=!1,this.isReplicated=!1,this.isErasure=!1,this.blobUnits=["B","KiB","MiB","GiB","TiB"],this.maxBytesUnits=["KiB","MiB","GiB","TiB"],this.data=new qn,this.externalPgChange=!1,this.current={rules:[]},this.initializeConfigData=new bt.ReplaySubject(1),this.currentConfigurationValues={},this.icons=I.FI,this.crushUsage=void 0,this.ecpUsage=void 0,this.crushRuleMaxSize=10,this.DEFAULT_RATIO=.875,this.isApplicationsSelected=!0,this.msrCrush=!1,this.editing=this.router.url.startsWith(`/pool/${g.Qp.EDIT}`),this.action=this.editing?this.actionLabels.EDIT:this.actionLabels.CREATE,this.resource=$localize`pool`,this.authenticate(),this.createForm()}authenticate(){if(this.permission=this.authStorageService.getPermissions().pool,!this.permission.read||!this.permission.update&&this.editing||!this.permission.create&&!this.editing)throw new It.YW}createForm(){const t=new je.$({mode:new l.UntypedFormControl("none"),algorithm:new l.UntypedFormControl(""),minBlobSize:new l.UntypedFormControl("",{updateOn:"blur"}),minBlobSizeUnit:new l.UntypedFormControl(this.blobUnits[0],{updateOn:"blur"}),maxBlobSize:new l.UntypedFormControl("",{updateOn:"blur"}),maxBlobSizeUnit:new l.UntypedFormControl(this.blobUnits[2],{updateOn:"blur"}),ratio:new l.UntypedFormControl(this.DEFAULT_RATIO,{updateOn:"blur"})});this.form=new je.$({name:new l.UntypedFormControl("",{validators:[l.Validators.pattern(/^[.A-Za-z0-9_/-]+$/),l.Validators.required,m.xQ.custom("rbdPool",()=>this.form&&this.form.getValue("name").includes("/")&&this.data&&-1!==this.data.applications.selected.indexOf("rbd"))]}),poolType:new l.UntypedFormControl("",{validators:[l.Validators.required]}),crushRule:new l.UntypedFormControl(null,{validators:[m.xQ.custom("tooFewOsds",n=>this.info&&n&&this.info.osd_count<1),m.xQ.custom("required",n=>this.isReplicated&&this.info?.crush_rules_replicated?.length>0&&!n)]}),size:new l.UntypedFormControl("",{updateOn:"blur"}),erasureProfile:new l.UntypedFormControl(null),pgNum:new l.UntypedFormControl("",{validators:[l.Validators.required]}),pgAutoscaleMode:new l.UntypedFormControl(null),ecOverwrites:new l.UntypedFormControl(!1),compression:t,max_bytes:new l.UntypedFormControl(""),maxBytesUnit:new l.UntypedFormControl(this.maxBytesUnits[2]),max_objects:new l.UntypedFormControl(0),rbdMirroring:new l.UntypedFormControl(!1)},[m.xQ.custom("form",()=>null)])}ngOnInit(){this.poolService.getInfo().subscribe(t=>{this.initInfo(t),this.editing?this.initEditMode():(this.setAvailableApps(),this.loadingReady()),this.listenToChanges(),this.setComplexValidators()}),this.erasureProfileChange()}initInfo(t){this.pgAutoscaleModes=t.pg_autoscale_modes,this.form.silentSet("pgAutoscaleMode",t.pg_autoscale_default_mode),this.form.silentSet("algorithm",t.bluestore_compression_algorithm),this.info=t,this.initEcp(t.erasure_code_profiles)}initEcp(t){this.setListControlStatus("erasureProfile",t),this.ecProfiles=t}setListControlStatus(t,n){const i=this.form.get(t),_=i.value;1!==n.length||_&&p().isEqual(_,n[0])?0===n.length&&_&&i.setValue(null):i.setValue(n[0]),n.length<=1?i.enabled&&i.disable():i.disabled&&i.enable()}initEditMode(){this.disableForEdit(),this.routeParamsSubscribe=this.route.params.subscribe(t=>this.poolService.get(t.name).subscribe(n=>{this.data.pool=n,this.initEditFormData(n),this.loadingReady()}))}disableForEdit(){["poolType","crushRule","size","erasureProfile","ecOverwrites"].forEach(t=>this.form.get(t).disable())}initEditFormData(t){this.initializeConfigData.next({initialData:t.configuration,sourceType:Ut.M.pool});const n=this.dimlessBinaryPipe.transform(t.quota_max_bytes).split(" "),i=this.dimlessBinaryPipe.transform(t.options.compression_min_blob_size).split(" "),_=this.dimlessBinaryPipe.transform(t.options.compression_max_blob_size).split(" ");this.poolTypeChange(t.type);const s=this.info.crush_rules_replicated.concat(this.info.crush_rules_erasure),d={name:t.pool_name,poolType:t.type,crushRule:s.find(O=>O.rule_name===t.crush_rule),size:t.size,erasureProfile:this.ecProfiles.find(O=>O.name===t.erasure_code_profile),pgAutoscaleMode:t.pg_autoscale_mode,pgNum:t.pg_num,ecOverwrites:t.flags_names.includes("ec_overwrites"),mode:t.options.compression_mode,algorithm:t.options.compression_algorithm,minBlobSize:i[0],minBlobSizeUnit:i[1],maxBlobSize:_[0],maxBlobSizeUnit:_[1],ratio:t.options.compression_required_ratio,max_bytes:n[0],maxBytesUnit:n[1],max_objects:t.quota_max_objects};Object.keys(d).forEach(O=>{const u=d[O];!p().isUndefined(u)&&""!==u&&this.form.silentSet(O,u)}),this.data.pgs=this.form.getValue("pgNum"),this.setAvailableApps(this.data.applications.default.concat(t.application_metadata)),this.data.applications.selected=t.application_metadata,this.rbdMirroringService.getPool(t.pool_name).subscribe(O=>{this.form.get("rbdMirroring").setValue("pool"===O.mirror_mode)})}setAvailableApps(t=this.data.applications.default){this.data.applications.available=p().uniq(t.sort()).map(n=>new yt.O(!1,n,this.data.APP_LABELS[n]||n))}listenToChanges(){this.listenToChangesDuringAddEdit(),this.editing||this.listenToChangesDuringAdd()}listenToChangesDuringAddEdit(){this.form.get("pgNum").valueChanges.subscribe(t=>{const n=t-this.data.pgs;1===Math.abs(n)&&2!==t?this.doPgPowerJump(n):this.data.pgs=t})}doPgPowerJump(t){const n=this.calculatePgPower()+t;this.setPgs(-1===t?Math.round(n):Math.floor(n))}calculatePgPower(t=this.form.getValue("pgNum")){return Math.log(t)/Math.log(2)}setPgs(t){const n=Math.pow(2,t<0?0:t);this.data.pgs=n,this.form.silentSet("pgNum",n)}listenToChangesDuringAdd(){this.form.get("poolType").valueChanges.subscribe(t=>{this.poolTypeChange(t)}),this.form.get("crushRule").valueChanges.subscribe(t=>{this.crushDeletionBtn&&this.crushDeletionBtn.isOpen()&&this.crushDeletionBtn.close(),t&&(this.setCorrectMaxSize(t),this.crushRuleIsUsedBy(t.rule_name),this.replicatedRuleChange(),this.pgCalc())}),this.form.get("size").valueChanges.subscribe(()=>{this.pgCalc()}),this.form.get("erasureProfile").valueChanges.subscribe(t=>{this.ecpDeletionBtn&&this.ecpDeletionBtn.isOpen()&&this.ecpDeletionBtn.close(),t&&(this.ecpIsUsedBy(t.name),this.pgCalc())}),this.form.get("mode").valueChanges.subscribe(()=>{["minBlobSize","maxBlobSize","ratio"].forEach(t=>{this.form.get(t).updateValueAndValidity({emitEvent:!1})})}),this.form.get("minBlobSize").valueChanges.subscribe(()=>{this.form.get("maxBlobSize").updateValueAndValidity({emitEvent:!1})}),this.form.get("minBlobSizeUnit").valueChanges.subscribe(()=>{this.form.get("maxBlobSize").updateValueAndValidity({emitEvent:!1})}),this.form.get("maxBlobSize").valueChanges.subscribe(()=>{this.form.get("minBlobSize").updateValueAndValidity({emitEvent:!1})}),this.form.get("maxBlobSizeUnit").valueChanges.subscribe(()=>{this.form.get("minBlobSize").updateValueAndValidity({emitEvent:!1})})}poolTypeChange(t){if("replicated"===t?this.setTypeBooleans(!0,!1):"erasure"===t?this.setTypeBooleans(!1,!0):this.setTypeBooleans(!1,!1),!t||!this.info)return void(this.current.rules=[]);const n=this.info["crush_rules_"+t]||[];this.current.rules=n,!this.editing&&(this.isReplicated&&this.setListControlStatus("crushRule",n),this.replicatedRuleChange(),this.pgCalc())}setTypeBooleans(t,n){this.isReplicated=t,this.isErasure=n}replicatedRuleChange(){if(!this.isReplicated)return;const t=this.form.get("size");let n=this.form.getValue("size")||3;const i=this.getMinSize(),_=this.getMaxSize();n<i?n=i:n>_&&(n=_),n!==t.value&&this.form.silentSet("size",n)}getMinSize(){return!this.info||this.info.osd_count<1?0:1}getMaxSize(){const t=this.form.getValue("crushRule");if(!this.info)return 0;if(!t){const n=this.info.osd_count;return Math.min(n,3)}return t.usable_size}pgCalc(){const t=this.form.getValue("poolType");if(!this.info||this.form.get("pgNum").dirty||!t)return;const n=100*this.info.osd_count,i=this.isReplicated?this.replicatedPgCalc(n):this.erasurePgCalc(n);if(!i)return;const _=this.data.pgs;this.alignPgs(i);const s=this.data.pgs;this.externalPgChange||(this.externalPgChange=_!==s)}setCorrectMaxSize(t=this.form.getValue("crushRule")){if(!t)return;const i=F.searchFailureDomains(this.info.nodes,t.steps[0].item_name)[t.steps[1].type],_=i?i.length:this.crushRuleMaxSize;t.usable_size=Math.min(_,this.crushRuleMaxSize)}replicatedPgCalc(t){const n=this.form.get("size"),i=n.value;return n.valid&&i>0?t/i:0}erasurePgCalc(t){const n=this.form.get("erasureProfile"),i=n.value;return(n.valid||n.disabled)&&i?t/(i.k+i.m):0}alignPgs(t=this.form.getValue("pgNum")){this.setPgs(Math.round(this.calculatePgPower(t<1?1:t)))}setComplexValidators(){this.editing?this.form.get("name").setValidators([this.form.get("name").validator,m.xQ.custom("uniqueName",t=>this.data.pool&&this.info&&-1!==this.info.pool_names.indexOf(t)&&this.info.pool_names.indexOf(t)!==this.info.pool_names.indexOf(this.data.pool.pool_name))]):(m.xQ.validateIf(this.form.get("size"),()=>this.isReplicated,[m.xQ.custom("min",t=>this.form.getValue("size")&&t<this.getMinSize()),m.xQ.custom("max",t=>this.form.getValue("size")&&this.getMaxSize()<t)]),this.form.get("name").setValidators([this.form.get("name").validator,m.xQ.custom("uniqueName",t=>this.info&&-1!==this.info.pool_names.indexOf(t))])),this.setCompressionValidators()}setCompressionValidators(){m.xQ.validateIf(this.form.get("minBlobSize"),()=>this.hasCompressionEnabled(),[l.Validators.min(0),m.xQ.custom("maximum",t=>this.oddBlobSize(t,this.form.getValue("minBlobSizeUnit"),this.form.getValue("maxBlobSize"),this.form.getValue("maxBlobSizeUnit")))]),m.xQ.validateIf(this.form.get("maxBlobSize"),()=>this.hasCompressionEnabled(),[l.Validators.min(0),m.xQ.custom("minimum",t=>this.oddBlobSize(this.form.getValue("minBlobSize"),this.form.getValue("minBlobSizeUnit"),t,this.form.getValue("maxBlobSizeUnit")))]),m.xQ.validateIf(this.form.get("ratio"),()=>this.hasCompressionEnabled(),[l.Validators.min(0),l.Validators.max(1)])}oddBlobSize(t,n,i,_){const s=this.formatter.toBytes(t+n),d=this.formatter.toBytes(i+_);return!!(s&&d&&s>=d)}hasCompressionEnabled(){return this.form.getValue("mode")&&"none"!==this.form.get("mode").value.toLowerCase()}describeCrushStep(t){return[t.op.replace("_"," "),t.item_name||"",t.type?t.num+" type "+t.type:""].join(" ")}addErasureCodeProfile(){this.addModal(Le,t=>this.reloadECPs(t))}addModal(t,n){this.hideOpenTooltips(),this.modalService.show(t).componentInstance.submitAction.subscribe(_=>{n(_.name)})}hideOpenTooltips(){const t=n=>n&&n.isOpen()&&n.close();t(this.ecpDeletionBtn),t(this.crushDeletionBtn)}reloadECPs(t){this.reloadList({newItemName:t,getInfo:()=>this.ecpService.list(),initInfo:n=>this.initEcp(n),findNewItem:()=>this.ecProfiles.find(n=>n.name===t),controlName:"erasureProfile"})}reloadList({newItemName:t,getInfo:n,initInfo:i,findNewItem:_,controlName:s}){this.modalSubscription&&this.modalSubscription.unsubscribe(),n().subscribe(d=>{if(i(d),!t)return;const O=_();O&&this.form.get(s).setValue(O)})}deleteErasureCodeProfile(){this.deletionModal({value:this.form.getValue("erasureProfile"),usage:this.ecpUsage,deletionBtn:this.ecpDeletionBtn,dataName:"erasureInfo",getTabs:()=>this.ecpInfoTabs,tabPosition:"used-by-pools",nameAttribute:"name",itemDescription:$localize`erasure code profile`,reloadFn:()=>this.reloadECPs(),deleteFn:t=>this.ecpService.delete(t),taskName:"ecp/delete"})}deletionModal({value:t,usage:n,deletionBtn:i,dataName:_,getTabs:s,tabPosition:d,nameAttribute:O,itemDescription:u,reloadFn:P,deleteFn:M,taskName:S}){if(!t)return;if(n)return i.animation=!1,i.toggle(),this.data[_]=!0,void setTimeout(()=>{const R=s();R&&R.select(d)},50);const C=t[O];this.modalService.show(Be.D,{itemDescription:u,itemNames:[C],submitActionObservable:()=>{const R=M(C);return R.subscribe(()=>P()),this.taskWrapper.wrapTaskAroundCall({task:new $.O(S,{name:C}),call:R})}})}addCrushRule(){this.addModal(Se,t=>this.reloadCrushRules(t))}reloadCrushRules(t){this.reloadList({newItemName:t,getInfo:()=>this.poolService.getInfo(),initInfo:n=>{this.initInfo(n),this.poolTypeChange("replicated")},findNewItem:()=>this.info.crush_rules_replicated.find(n=>n.rule_name===t),controlName:"crushRule"})}deleteCrushRule(){this.deletionModal({value:this.form.getValue("crushRule"),usage:this.crushUsage,deletionBtn:this.crushDeletionBtn,dataName:"crushInfo",getTabs:()=>this.crushInfoTabs,tabPosition:"used-by-pools",nameAttribute:"rule_name",itemDescription:$localize`crush rule`,reloadFn:()=>this.reloadCrushRules(),deleteFn:t=>this.crushRuleService.delete(t),taskName:"crushRule/delete"})}crushRuleIsUsedBy(t){this.crushUsage=t?this.info.used_rules[t]:void 0}ecpIsUsedBy(t){this.ecpUsage=t?this.info.used_profiles[t]:void 0}submit(){if(this.form.invalid)return void this.form.setErrors({cdSubmitButton:!0});const t={pool:this.form.getValue("name")};this.assignFormFields(t,[{externalFieldName:"pool_type",formControlName:"poolType"},{externalFieldName:"pg_autoscale_mode",formControlName:"pgAutoscaleMode",editable:!0},{externalFieldName:"pg_num",formControlName:"pgNum",replaceFn:i=>"on"===this.form.getValue("pgAutoscaleMode")?1:i,editable:!0},this.isReplicated?{externalFieldName:"size",formControlName:"size"}:{externalFieldName:"erasure_code_profile",formControlName:"erasureProfile",attr:"name"},{externalFieldName:"rule_name",formControlName:"crushRule",replaceFn:i=>this.isReplicated?i&&i.rule_name:void 0},{externalFieldName:"quota_max_bytes",formControlName:"max_bytes",replaceFn:i=>{const _=this.form.getValue("maxBytesUnit");return this.formatter.toBytes(i+_)},editable:!0,resetValue:this.editing?0:void 0},{externalFieldName:"quota_max_objects",formControlName:"max_objects",editable:!0,resetValue:this.editing?0:void 0},this.data.applications.selected.includes("rbd")?{externalFieldName:"rbd_mirroring",formControlName:"rbdMirroring"}:{externalFieldName:"rbd_mirroring",formControlName:"rbdMirroring",resetValue:void 0}]),this.info.is_all_bluestore&&(this.assignFormField(t,{externalFieldName:"flags",formControlName:"ecOverwrites",replaceFn:()=>this.isErasure?["ec_overwrites"]:void 0}),"none"!==this.form.getValue("mode")?this.assignFormFields(t,[{externalFieldName:"compression_mode",formControlName:"mode",editable:!0,replaceFn:i=>this.hasCompressionEnabled()&&i},{externalFieldName:"compression_algorithm",formControlName:"algorithm",editable:!0},{externalFieldName:"compression_min_blob_size",formControlName:"minBlobSize",replaceFn:i=>{const _=this.form.getValue("minBlobSizeUnit");return this.formatter.toBytes(i+_)},editable:!0,resetValue:0},{externalFieldName:"compression_max_blob_size",formControlName:"maxBlobSize",replaceFn:i=>{const _=this.form.getValue("maxBlobSizeUnit");return this.formatter.toBytes(i+_)},editable:!0,resetValue:0},{externalFieldName:"compression_required_ratio",formControlName:"ratio",editable:!0,resetValue:0}]):this.editing&&this.assignFormFields(t,[{externalFieldName:"compression_mode",formControlName:"mode",editable:!0,replaceFn:()=>"unset"},{externalFieldName:"srcpool",formControlName:"name",editable:!0,replaceFn:()=>this.data.pool.pool_name}]));const n=this.data.applications.selected;n.length>0||this.editing?(t.application_metadata=n,n.includes("rbd")&&(t.rbd_mirroring=this.form.getValue("rbdMirroring")),this.isApplicationsSelected=!0):this.isApplicationsSelected=!1,this.isReplicated&&!p().isEmpty(this.currentConfigurationValues)&&(t.configuration=this.currentConfigurationValues),this.isApplicationsSelected?this.triggerApiTask(t):this.form.setErrors({cdSubmitButton:!0})}assignFormFields(t,n){n.forEach(i=>this.assignFormField(t,i))}assignFormField(t,{externalFieldName:n,formControlName:i,attr:_,replaceFn:s,editable:d,resetValue:O}){if(this.editing&&(!d||this.form.get(i).pristine))return;const u=this.form.getValue(i);let P=s?s(u):_?p().get(u,_):u;if(!u||!P){if(!d||p().isUndefined(O))return;P=O}t[n]=P}triggerApiTask(t){const n=t.hasOwnProperty("srcpool")?t.srcpool:t.pool;this.taskWrapper.wrapTaskAroundCall({task:new $.O("pool/"+(this.editing?g.Qp.EDIT:g.Qp.CREATE),{pool_name:n}),call:this.poolService[this.editing?g.Qp.UPDATE:g.Qp.CREATE](t)}).subscribe({error:i=>{p().isObject(i.error)&&"34"===i.error.code&&this.form.get("pgNum").setErrors({34:!0}),this.form.setErrors({cdSubmitButton:!0})},complete:()=>this.router.navigate(["/pool"])})}appSelection(){this.form.get("name").updateValueAndValidity({emitEvent:!1,onlySelf:!0})}erasureProfileChange(){const t=this.form.get("erasureProfile").value;t&&(this.msrCrush=t["crush-num-failure-domains"]>0||t["crush-osds-per-failure-domain"]>0)}static{this.\u0275fac=function(n){return new(n||D)(e.\u0275\u0275directiveInject(Gt.l),e.\u0275\u0275directiveInject(ge.ActivatedRoute),e.\u0275\u0275directiveInject(ge.Router),e.\u0275\u0275directiveInject(Ht.B),e.\u0275\u0275directiveInject(Ae.m),e.\u0275\u0275directiveInject(qe.v),e.\u0275\u0275directiveInject(zt.k),e.\u0275\u0275directiveInject(Me.a),e.\u0275\u0275directiveInject(T),e.\u0275\u0275directiveInject(ke.j),e.\u0275\u0275directiveInject(g.Ss),e.\u0275\u0275directiveInject(Qn.B))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:D,selectors:[["cd-pool-form"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(Zn,5),e.\u0275\u0275viewQuery(eo,5),e.\u0275\u0275viewQuery(to,5),e.\u0275\u0275viewQuery(no,5)),2&n){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.crushInfoTabs=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.crushDeletionBtn=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.ecpInfoTabs=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.ecpDeletionBtn=_.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:()=>{let t,n,i,_,s,d,O,u,P,M,S,C,R,L,f,x,U,G,z,H,X,V,w,k,B,j,q,Q,J,K,W,Y,Z,ee,te,ne,oe,ie,A,_e,ae,le,re,se,de,ce,Oe,me,ue,Ee,pe,fe,v,Pe,Ce,Re,c,nt,ot,it,_t,at,lt,rt,st,dt,ct,Ot,mt,ut,Et,pt,ft,Pt,Ct,Rt,gt,Mt,St,ht,Lt,Ft;return t=$localize`:␟2fecea01ce1d44114ee45144eff6d47a5016a74f␟5451140586403689891:Name...`,n=$localize`:␟b24398695821051a5348b3756481b38261a8edc0␟6814278963931082774:Pools should be associated with an application tag`,i=$localize`:form title|Example\: Create Pool@@formTitle␟f1553045110d959c485a73c7f40f26fcc28b975b␟6476422032353420938:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,_=$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,s=$localize`:␟b85c657469e5ec8231c3de99b22f437bc01ffde5␟9172197321150709390:Pool type`,d=$localize`:␟526c5443254c3b126eedb264840ffe827727bfd3␟1562903615362783646:-- Select a pool type --`,O=$localize`:␟f1abafaeb40ce52355ddcc24686e3cd17b64e08a␟6658000829978978023:Applications`,u=$localize`:␟2f489cbd49eee59cbc135b7c919cbdd0e7a625cd␟3758994608227054054:Pools need to be associated with an application before use`,P=$localize`:␟8bb8293aa8161433778762ae025ffd5e7c85795e␟8133124082907931904:Quotas`,M=$localize`:␟d99b34162c9c34f10d0ccd8dbae83d8569c2db77␟3747015173044998769:Max bytes`,S=$localize`:␟a1d14a18879c62f3f4ed705318b7164a1160e249␟1598148565161940221:Leave it blank or specify 0 to disable this quota.`,C=$localize`:␟7565b131562ff6c5f769fdbd239a772154abdd97␟4793948312117174353:A valid quota should be greater than 0.`,R=$localize`:␟b8bf35b66f09a301eef92ffc3cb2fd259df67ce9␟8598004196729643782:Max objects`,L=$localize`:␟a1d14a18879c62f3f4ed705318b7164a1160e249␟1598148565161940221:Leave it blank or specify 0 to disable this quota.`,f=$localize`:␟7565b131562ff6c5f769fdbd239a772154abdd97␟4793948312117174353:A valid quota should be greater than 0.`,x=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,U=$localize`:␟16e113230b6b0d3165e076300880542bac7c8138␟8856591561953003570:The chosen Ceph pool name is already in use.`,G=$localize`:␟c75b132bef7b29fa5171768303c4b96e34ccaf68␟4019421115201218895:It's not possible to create an RBD pool with '/' in the name. Please change the name or remove 'rbd' from the applications list.`,z=$localize`:␟171dc6d5c6bc4615d99778b0088cae80fd00bd10␟6150797013332470255:Pool name can only contain letters, numbers, '.', '-', '_' or '/'.`,H=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,X=$localize`:␟6abfbe47b630929d93c7343dc154599c2e59330a␟8225008431655447514:PG Autoscale`,V=$localize`:␟80ac68cd883369dac20688bc32b4cb33291b5e50␟6631156531520249661:Calculation help`,w=$localize`:␟0aa21053410a94aa61d16985a4e95fd65523430d␟3752428261896460601:Placement groups`,k=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,B=$localize`:␟6301f1391d726f8f450bb358058534db19541ca9␟5406317697422969407:At least one placement group is needed!`,j=$localize`:␟ba9469a1ce6ed36e039c1f67247c8c81a5c71449␟5229921545530078803:Your cluster can't handle this many PGs. Please recalculate the PG amount needed.`,q=$localize`:␟fccbd60493df26705d957ed6c02a3c447894678f␟1689749228990488417:The current PGs settings were calculated for you, you should make sure the values suit your needs before submit.`,Q=$localize`:␟a43b2695131b48b76cebba676aba98a2bee17515␟752603623252877510:Replicated size`,J=$localize`:␟7bff144a4c4dc63b0e18fff2617d61a7ebdf2b6c␟8024883227048914975:Minimum: ${"\ufffd0\ufffd"}:INTERPOLATION:`,K=$localize`:␟1a9c54b41f6d58a74e5d0aa3429ed0c87a482551␟590459149466870284:Maximum: ${"\ufffd0\ufffd"}:INTERPOLATION:`,W=$localize`:␟452cf71ec44ee77428656936a6627eaf2dd3b47f␟7377369889112759555:The size specified is out of range. A value from ${"\ufffd0\ufffd"}:INTERPOLATION: to ${"\ufffd1\ufffd"}:INTERPOLATION_1: is usable.`,Y=$localize`:␟dda6196ffab88c1825f44a565c7b34e246e7e12f␟6448090406949650356:A size of 1 will not create a replication of the object. The 'Replicated size' includes the object itself.`,Z=$localize`:␟920617c6a1a4805e53bcb5af6a9c76f8387e89c6␟2870788902465061969:Flags`,ee=$localize`:␟1c870fb00256b8a5b9cb9cd1a124e6390b9bc639␟2339012409163744944:EC Overwrites`,te=$localize`:␟b6adc9bfc526fb9558ad1f021974d49fb2a3d3d6␟8660945900757367669:Application selection is required!`,ne=$localize`:␟3c2562ba992127203dcfd014010b03cb7b8113c6␟3154623626913350957:Mirroring`,oe=$localize`:␟44e6a0ef52d225e2524120fe99b4e043ace9887a␟6084891037005621686:Check this option to enable Pool based mirroring on a Block(RBD) pool.`,ie=$localize`:␟fb9308b82fc183f710df60909f49cfc73aa5e076␟4223321256203872325:CRUSH`,A=$localize`:␟616a2532fbaace94934f5943e381b63e2623f004␟6905261999855103308:This profile can't be deleted as it is in use.`,_e=$localize`:␟9de7dde00e2139cc4bd03b1837afbe72ad15a1ff␟6153130195101626553:Erasure code profile`,ae=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,le=$localize`:␟39b4620e6bd444e0a57a0a5c03fa8c96d7fe5235␟5674504811107661466:-- No erasure code profile available --`,re=$localize`:␟498561757390d5528b263ce450d5f38efb00266d␟4561644255051104925:-- Select an erasure code profile --`,se=$localize`:␟994363f08f9fbfa3b3994ff7b35c6904fdff18d8␟4915431133669985304:Profile`,de=$localize`:␟023d6f718770d2ea4ab8cabe26b0ec27ef967ec2␟6388596708833227105:Used by pools`,ce=$localize`:␟b1061ba5ee07a5c6af09e09330dbc29201baf2aa␟7364943935614077636:Profile is not in use.`,Oe=$localize`:␟33150f22ce5348aa6c499bd092c3f4f3695d62cc␟2316779381850545017:Crush ruleset`,me=$localize`:␟c69b0bcd4698aa845d32c4c4ad488492552cb469␟491350185559594401:A new crush ruleset will be implicitly created.`,ue=$localize`:␟0c9a76d8eb7d0da14a358a6abfa3a27968736582␟2290427802662977523:A new crush MSR ruleset will be implicitly created. When crush-osds-per-failure-domain or crush-num-failure-domains is specified`,Ee=$localize`:␟33150f22ce5348aa6c499bd092c3f4f3695d62cc␟2316779381850545017:Crush ruleset`,pe=$localize`:␟896e9987db5e9bb279e6deed5d2dff28c242ef66␟2479750831776663300:There are no rules.`,fe=$localize`:␟b4d4ca3dbd0212d685d7589be41284b0d5960a50␟1472531588308219240:Placement and
                          replication strategies or distribution policies that allow to
                          specify how CRUSH places data replicas.`,v=$localize`:␟ea91d648f92002bc9f96d9b26b735c83ca0b53c6␟2703635065523295547:This rule can't be deleted as it is in use.`,Pe=$localize`:␟73a6b31116b3cc322af951daa0bafdc169e6c42e␟4463049516277766604:-- Select a crush rule --`,Ce=$localize`:␟92da80699921e89fb19372e25b8d0f3b9fa427fc␟5675468447288802964:Crush rule`,Re=$localize`:␟5489e9f96835f469f6f728a00d8efa88ea5bc940␟8605423809073301009:Crush steps`,c=$localize`:␟023d6f718770d2ea4ab8cabe26b0ec27ef967ec2␟6388596708833227105:Used by pools`,nt=$localize`:␟fc5f5496a9e50fe69e1a09784f28d94944108294␟1616247679170810690:Rule is not in use.`,ot=$localize`:␟4aa19de2a2b54cbda39e9c62917b23044c087776␟751124305869330542:This field is required!`,it=$localize`:␟104a0e6900d1d1b0c8cf9e5947e36edb352583fc␟983890247184422369:The rule can't be used in the current cluster as it has too few OSDs to meet the minimum required OSD by this rule.`,_t=$localize`:␟2208d63d5940ce656006a220102b1eb2b5e553da␟3454103840680130627:Compression`,at=$localize`:␟e79b3795fab22dff7224fe1f748d490ee1b1e49c␟3625019478172002657:Mode `,lt=$localize`:␟e8b7f16e6ed7fe4cb0f92a7b5e2ea93e2ede1aa3␟1969389149120273315:e.g., 128`,rt=$localize`:␟6c6f25c47da62ec597c6057a36ddfc3209811ec5␟4824444844546691624:Algorithm`,st=$localize`:␟608ffb5fa57d6e25118432dfa4da6dbf4169c70b␟1743559614206500458:Compression algorithm used`,dt=$localize`:␟5d68ddb254275f8f44221e9ad6d8ceeb59ca46a6␟6531705700837194039:Minimum blob size`,ct=$localize`:␟fb40a76dd22b0669399f186ad2d55da923afbc9e␟6606371171234917008:Chunks smaller than Minimum blob size are never compressed`,Ot=$localize`:␟151efb127a9a4dd25259a0b2055442318a141f5b␟9193074744671457730:Maximum blob size`,mt=$localize`:␟6db9a47cd7e51a93b35831e3c6605185cd7b9d2f␟8570508675064800531:Chunks larger than \`Maximum Blob Size\` are broken into smaller blobs of size mentioned before being compressed.`,ut=$localize`:␟261ba09c4a59de83f48f52a23fd328da37e61ff4␟1712198024026254502:Ratio`,Et=$localize`:␟56f709cda7d2eaed90b3dcf4b6aafc5cef9b2b28␟2362794024575629976:The ratio of the size of the data chunk after compression relative to the original size must be at least this small in order to store the compressed version`,pt=$localize`:␟94516fa213706c67ce5a5b5765681d7fb032033a␟3894950702316166331:Loading...`,ft=$localize`:␟4903231d42089325a28892c0fde1aed46b733ae6␟1965973164609184105:-- No erasure compression algorithm available --`,Pt=$localize`:␟1b7f6e53a4521c6eb3ced4c007fdd4cf80bb7707␟5098375923930423409:Value should be greater than 0`,Ct=$localize`:␟8db98ab14b4e207ec763dfdefbc2dae367aab1cc␟2571669501100650073:Value should be less than the maximum blob size`,Rt=$localize`:␟25db023269cd62168393b201f615ec90e07f3df8␟4749416028992272245:Size must be a number or in a valid format. eg: 5 GiB`,gt=$localize`:␟1b7f6e53a4521c6eb3ced4c007fdd4cf80bb7707␟5098375923930423409:Value should be greater than 0`,Mt=$localize`:␟0a65a24eee8a026f3b1113fe9e157e9a0dd69486␟1889107216619939776:Value should be greater than the minimum blob size`,St=$localize`:␟25db023269cd62168393b201f615ec90e07f3df8␟4749416028992272245:Size must be a number or in a valid format. eg: 5 GiB`,ht=$localize`:␟ae5ce6de352cde949998fb10754459c3a4eb183b␟1115761569439758411:Value should be between 0.0 and 1.0`,Lt=$localize`:␟25db023269cd62168393b201f615ec90e07f3df8␟4749416028992272245:Size must be a number or in a valid format. eg: 5 GiB`,Ft=$localize`:␟95f348167622d832c5ae532b6944635c8e2ae5cb␟5025817128790551445:The value should be greater or equal to 0`,[["formDir","ngForm"],["ecpDeletionBtn","ngbTooltip"],["ecpInfoTabs","ngbNav"],["ecpIsNotUsed",""],["msrCrushText",""],["noRules",""],["crushDeletionBtn","ngbTooltip"],["crushInfoTabs","ngbNav"],["ruleIsNotUsed",""],i,_,s,d,O,u,P,M,S,C,R,L,f,x,U,G,z,H,X,w,k,B,j,q,Q,J,K,W,Y,Z,ee,te,ne,oe,ie,_e,ae,le,re,se,de,ce,Oe,me,ue,Ee,pe,Pe,Ce,Re,c,nt,ot,it,_t,at,rt,st,dt,ct,Ot,mt,ut,Et,pt,ft,Pt,Ct,Rt,gt,Mt,St,ht,Lt,Ft,["class","cd-col-form",4,"cdFormLoading"],[1,"cd-col-form"],["name","form","novalidate","",3,"formGroup"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"form-group","row"],["for","name",1,"cd-col-form-label","required"],[1,"cd-col-form-input"],["data-testid","pool-name","id","name","type","text","placeholder",t,"formControlName","name","autofocus","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","poolType",1,"cd-col-form-label","required"],["data-testid","pool-type-select","id","poolType","formControlName","poolType",1,"form-select"],["ngValue",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["for","applications",1,"cd-col-form-label","required"],["id","applications",3,"selection","customBadges","customBadgeValidators","messages","data","options","selectionLimit"],["title",n,"class","cds-warning-color",3,"cdsIcon","size",4,"ngIf"],["class","form-group row",4,"ngIf"],["formGroupName","compression",4,"ngIf"],["for","max_bytes",1,"cd-col-form-label"],[1,"input-group","mb-1"],["id","max_bytes","type","text","formControlName","max_bytes",1,"form-control"],["id","unit","formControlName","maxBytesUnit",1,"form-input","form-select"],["for","max_objects",1,"cd-col-form-label"],["id","max_objects","min","0","type","number","formControlName","max_objects",1,"form-control"],[3,"hidden"],[3,"changes","form","initializeData"],[1,"card-footer"],["wrappingClass","text-right",3,"submitActionEvent","form","submitText"],[1,"invalid-feedback"],[3,"value"],["for","pgAutoscaleMode",1,"cd-col-form-label"],["id","pgAutoscaleMode","formControlName","pgAutoscaleMode",1,"form-select"],["for","pgNum",1,"cd-col-form-label","required"],["id","pgNum","data-testid","pgNum","formControlName","pgNum","min","1","type","number","required","",1,"form-control",3,"focus","blur"],[1,"form-text","text-muted"],["section","pgs","docText",V],["class","form-text text-muted",4,"ngIf"],["for","size",1,"cd-col-form-label","required"],["id","size","type","number","formControlName","size",1,"form-control",3,"max","min"],["class","text-warning-dark",4,"ngIf"],[1,"list-inline"],[1,"text-warning-dark"],[1,"cd-col-form-label"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","ec-overwrites","formControlName","ecOverwrites",1,"custom-control-input"],["for","ec-overwrites",1,"custom-control-label"],["title",n,1,"cds-warning-color",3,"cdsIcon","size"],[1,"cd-col-form-offset"],["id","rbdMirroring","data-testid","rbd-mirroring-check","type","checkbox","formControlName","rbdMirroring",1,"custom-control-input"],["for","rbdMirroring",1,"custom-control-label"],["for","erasureProfile",1,"cd-col-form-label"],["id","erasureProfile","formControlName","erasureProfile",1,"form-select",3,"change"],["ngValue","",4,"ngIf"],[3,"ngValue",4,"ngIf"],[3,"ngValue",4,"ngFor","ngForOf"],["id","ecp-info-button","type","button",1,"btn","btn-light",3,"click","ngClass"],[1,"cds-info-color",3,"cdsIcon","size"],["class","btn btn-light","type","button",3,"click",4,"ngIf"],["class","btn btn-light","type","button","ngbTooltip",A,"triggers","manual",3,"click",4,"ngIf"],["class","form-text text-muted","id","ecp-info-block",4,"ngIf"],[3,"ngValue"],["type","button",1,"btn","btn-light",3,"click"],["type","button","ngbTooltip",A,"triggers","manual",1,"btn","btn-light",3,"click"],["id","ecp-info-block",1,"form-text","text-muted"],["ngbNav","",1,"nav-tabs"],["ngbNavItem","ecp-info"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","used-by-pools"],[3,"ngbNavOutlet"],[3,"renderObjects","hideKeys","data","autoReload"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],["for","crushRule",1,"cd-col-form-label"],["class","form-text text-muted",4,"ngIf","ngIfElse"],[1,"input-group"],["id","crushRule","formControlName","crushRule",1,"form-select"],["id","crush-info-button","type","button","ngbTooltip",fe,1,"btn","btn-light",3,"click","ngClass"],["class","btn btn-light","type","button","ngbTooltip",v,"triggers","manual",3,"click",4,"ngIf"],["class","form-text text-muted","id","crush-info-block",4,"ngIf"],["type","button","ngbTooltip",v,"triggers","manual",1,"btn","btn-light",3,"click"],["id","crush-info-block",1,"form-text","text-muted"],["ngbNavItem","crush-rule-info"],["ngbNavItem","crush-rule-steps"],["formGroupName","compression"],["for","mode",1,"cd-col-form-label"],["id","mode","formControlName","mode",1,"form-select"],["for","algorithm",1,"cd-col-form-label"],["id","algorithm","formControlName","algorithm",1,"form-select"],["for","minBlobSize",1,"cd-col-form-label"],["id","minBlobSize","formControlName","minBlobSize","type","text","min","0","placeholder",lt,1,"form-control"],["id","minUnit","formControlName","minBlobSizeUnit",1,"form-input","form-select"],["for","maxBlobSize",1,"cd-col-form-label"],["id","maxBlobSize","type","text","min","0","formControlName","maxBlobSize",1,"form-control"],["id","minUnit","formControlName","maxBlobSizeUnit",1,"form-input","form-select"],["for","ratio",1,"cd-col-form-label"],["id","ratio","formControlName","ratio","type","number","min","0","max","1","step","0.1",1,"form-control"]]},template:function(n,i){1&n&&e.\u0275\u0275template(0,hi,80,37,"div",84),2&n&&e.\u0275\u0275property("cdFormLoading",i.loading)},dependencies:[h.NgClass,h.NgForOf,h.NgIf,E.NgbNavContent,E.NgbNav,E.NgbNavItem,E.NgbNavLink,E.NgbNavLinkBase,E.NgbNavOutlet,ve.m,Jn.U,Kn.C,be.e,Ie.O,We.i,$e.B,Wn.G,De.S,ye.a,xe.C,Ue.E,l.\u0275NgNoValidate,l.NgSelectOption,l.\u0275NgSelectMultipleOption,l.DefaultValueAccessor,l.NumberValueAccessor,l.CheckboxControlValueAccessor,l.SelectControlValueAccessor,l.NgControlStatus,l.NgControlStatusGroup,l.RequiredValidator,l.MinValidator,l.MaxValidator,l.FormGroupDirective,l.FormControlName,l.FormGroupName,E.NgbTooltip,Yn.c,he.IconDirective,h.TitleCasePipe,Ge.r],styles:[".icon-warning-color[_ngcontent-%COMP%]{margin-left:3px}"]})}}var Li=r(50619),Fi=r(97421),Ti=r(10978),Ni=r(25947),ze=r(2243),He=r(62847),N=r(2148),Ai=r(29130),vi=r(19380),bi=r(18457),Ze=r(58510),Xe=r(2361);class Ii{constructor(t){this.pool_name=t}}var $i=r(94254),Di=r(22453),yi=r(68316),et=r(1505),xi=r(32295),Ui=r(45843),Gi=r(71656),tt=r(32609),zi=r(62988),Hi=r(15224);function Xi(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-table-key-value",14),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("renderObjects",!0)("data",n.poolDetails)("autoReload",!1)}}function Vi(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-grafana",16),2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275propertyInterpolate1("grafanaPath","ceph-pool-detail?var-pool_name=",n.selection.pool_name,""),e.\u0275\u0275property("type","metrics")}}function wi(o,t){1&o&&(e.\u0275\u0275elementContainerStart(0,15),e.\u0275\u0275elementStart(1,"a",8),e.\u0275\u0275i18n(2,2),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Vi,1,3,"ng-template",9),e.\u0275\u0275elementContainerEnd())}function ki(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-rbd-configuration-table",18),2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("data",n.selectedPoolConfiguration)}}function Bi(o,t){1&o&&(e.\u0275\u0275elementContainerStart(0,17),e.\u0275\u0275elementStart(1,"a",8),e.\u0275\u0275i18n(2,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,ki,1,1,"ng-template",9),e.\u0275\u0275elementContainerEnd())}function ji(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-table",20),2&o){const n=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("data",n.cacheTiers)("columns",n.cacheTierColumns)("autoSave",!1)}}function qi(o,t){1&o&&(e.\u0275\u0275elementContainerStart(0,19),e.\u0275\u0275elementStart(1,"a",8),e.\u0275\u0275i18n(2,4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,ji,1,3,"ng-template",9),e.\u0275\u0275elementContainerEnd())}function Qi(o,t){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"nav",6,0),e.\u0275\u0275elementContainerStart(3,7),e.\u0275\u0275elementStart(4,"a",8),e.\u0275\u0275i18n(5,1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,Xi,1,3,"ng-template",9),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(7,wi,4,0,"ng-container",10)(8,Bi,4,0,"ng-container",11)(9,qi,4,0,"ng-container",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"div",13),e.\u0275\u0275elementContainerEnd()),2&o){const n=e.\u0275\u0275reference(2),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",i.permissions.grafana.read),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf","replicated"===i.selection.type),e.\u0275\u0275advance(),e.\u0275\u0275property("ngIf",(null==i.selection.tiers?null:i.selection.tiers.length)>0),e.\u0275\u0275advance(),e.\u0275\u0275property("ngbNavOutlet",n)}}class Fe{constructor(t){this.poolService=t,this.cacheTierColumns=[],this.omittedPoolAttributes=["cdExecuting","cdIsBinary","stats"],this.cacheTierColumns=[{prop:"pool_name",name:$localize`Name`,flexGrow:3},{prop:"cache_mode",name:$localize`Cache Mode`,flexGrow:2},{prop:"cache_min_evict_age",name:$localize`Min Evict Age`,flexGrow:2},{prop:"cache_min_flush_age",name:$localize`Min Flush Age`,flexGrow:2},{prop:"target_max_bytes",name:$localize`Target Max Bytes`,flexGrow:2},{prop:"target_max_objects",name:$localize`Target Max Objects`,flexGrow:2}]}ngOnChanges(){this.selection&&(this.poolService.getConfiguration(this.selection.pool_name).subscribe(t=>{tt.c.updateChanged(this,{selectedPoolConfiguration:t})}),tt.c.updateChanged(this,{poolDetails:p().omit(this.selection,this.omittedPoolAttributes)}))}static{this.\u0275fac=function(n){return new(n||Fe)(e.\u0275\u0275directiveInject(Ae.m))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Fe,selectors:[["cd-pool-details"]],inputs:{cacheTiers:"cacheTiers",permissions:"permissions",selection:"selection"},features:[e.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:()=>{let t,n,i,_,s;return t=$localize`:␟4f8b2bb476981727ab34ed40fde1218361f92c45␟5028777105388019087:Details`,n=$localize`:␟fbbaf5cb02ed419e79a27072478f716a4666a99d␟9041763226911499160:Performance Details`,i=$localize`:␟80f1fd18140ae414b5f765b3cfb3e07529b2b725␟4382964053540797190:Pool details`,_=$localize`:␟4a41f824a35ba01d5bd7be61aa06b3e8145209d0␟3008420115644088420:Configuration`,s=$localize`:␟3938a411d76796f8ae73b72ea4c77661207453bd␟4064628532851090088:Cache Tiers Details`,[["nav","ngbNav"],t,n,_,s,[4,"ngIf"],["ngbNav","","cdStatefulTab","pool-details",1,"nav-tabs"],["ngbNavItem","details"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","performance-details",4,"ngIf"],["ngbNavItem","configuration",4,"ngIf"],["ngbNavItem","cache-tiers-details",4,"ngIf"],[3,"ngbNavOutlet"],[3,"renderObjects","data","autoReload"],["ngbNavItem","performance-details"],["title",i,"uid","-xyV8KCiz","grafanaStyle","three",3,"grafanaPath","type"],["ngbNavItem","configuration"],[3,"data"],["ngbNavItem","cache-tiers-details"],["columnMode","flex",3,"data","columns","autoSave"]]},template:function(n,i){1&n&&e.\u0275\u0275template(0,Qi,11,4,"ng-container",5),2&n&&e.\u0275\u0275property("ngIf",i.selection)},dependencies:[h.NgIf,E.NgbNavContent,E.NgbNav,E.NgbNavItem,E.NgbNavLink,E.NgbNavLinkBase,E.NgbNavOutlet,et.c,He.O,We.i,zi.B,Hi.k],changeDetection:0})}}const Ji=["poolUsageTpl"],Ki=["poolConfigurationSourceTpl"];function Wi(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-pool-details",14),2&o){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("selection",n.expandedRow)("permissions",n.permissions)("cacheTiers",n.cacheTiers)}}function Yi(o,t){if(1&o){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"cd-table",11,2),e.\u0275\u0275listener("fetchData",function(){e.\u0275\u0275restoreView(n);const _=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(_.taskListService.fetch())})("setExpandedRow",function(_){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.setExpandedRow(_))})("updateSelection",function(_){e.\u0275\u0275restoreView(n);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.updateSelection(_))}),e.\u0275\u0275element(2,"cd-table-actions",12),e.\u0275\u0275template(3,Wi,1,3,"cd-pool-details",13),e.\u0275\u0275elementEnd()}if(2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("data",n.pools)("columns",n.columns)("hasDetails",!0)("status",n.tableStatus)("autoReload",-1),e.\u0275\u0275advance(2),e.\u0275\u0275property("permission",n.permissions.pool)("selection",n.selection)("tableActions",n.tableActions)}}function Zi(o,t){1&o&&e.\u0275\u0275element(0,"cd-grafana",15),2&o&&e.\u0275\u0275property("grafanaPath","ceph-pools-overview?")("type","metrics")}function e_(o,t){1&o&&(e.\u0275\u0275elementContainerStart(0,6),e.\u0275\u0275elementStart(1,"a",7),e.\u0275\u0275i18n(2,4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Zi,1,2,"ng-template",8),e.\u0275\u0275elementContainerEnd())}function t_(o,t){if(1&o&&e.\u0275\u0275element(0,"cd-usage-bar",17),2&o){const n=e.\u0275\u0275nextContext().data.row;e.\u0275\u0275property("total",n.stats.bytes_used.latest+n.stats.avail_raw.latest)("used",n.stats.bytes_used.latest)("title",n.pool_name)}}function n_(o,t){if(1&o&&e.\u0275\u0275template(0,t_,1,3,"cd-usage-bar",16),2&o){const n=t.data.row;e.\u0275\u0275property("ngIf",null==n.stats||null==n.stats.avail_raw?null:n.stats.avail_raw.latest)}}const Ve="pool";class Te extends Ni.D{constructor(t,n,i,_,s,d,O,u,P,M,S){super(),this.poolService=t,this.taskWrapper=n,this.ecpService=i,this.authStorageService=_,this.taskListService=s,this.modalService=d,this.pgCategoryService=O,this.dimlessPipe=u,this.urlBuilder=P,this.configurationService=M,this.actionLabels=S,this.selection=new vi.y,this.executingTasks=[],this.tableStatus=new ze.m,this.cacheTiers=[],this.monAllowPoolDelete=!1,this.permissions=this.authStorageService.getPermissions(),this.tableActions=[{permission:"create",icon:I.FI.add,routerLink:()=>this.urlBuilder.getCreate(),name:this.actionLabels.CREATE},{permission:"update",icon:I.FI.edit,routerLink:()=>this.urlBuilder.getEdit(encodeURIComponent(this.selection.first().pool_name)),name:this.actionLabels.EDIT},{permission:"delete",icon:I.FI.destroy,click:()=>this.deletePoolModal(),name:this.actionLabels.DELETE,disable:this.getDisableDesc.bind(this)}],this.permissions.configOpt.read&&this.configurationService.get("mon_allow_pool_delete").subscribe(C=>{if(p().has(C,"value")){const R=p().find(C.value,L=>"mon"===L.section)||{value:!1};this.monAllowPoolDelete="true"===R.value}})}ngOnInit(){const t=(n,i,_)=>p().get(i,n)>p().get(_,n)?1:-1;this.columns=[{prop:"pool_name",name:$localize`Name`,flexGrow:2,cellTransformation:N.x.executing},{prop:"data_protection",name:$localize`Data Protection`,cellTransformation:N.x.badge,customTemplateConfig:{class:"badge-background-gray"},flexGrow:1.3},{prop:"application_metadata",name:$localize`Applications`,cellTransformation:N.x.badge,customTemplateConfig:{class:"badge-background-primary"},flexGrow:1.5},{prop:"pg_status",name:$localize`PG Status`,flexGrow:1.2,cellClass:({row:n,column:i,value:_})=>this.getPgStatusCellClass(n,i,_)},{prop:"crush_rule",name:$localize`Crush Ruleset`,isHidden:!0,flexGrow:2},{name:$localize`Usage`,prop:"usage",cellTemplate:this.poolUsageTpl,flexGrow:1.2},{prop:"stats.rd_bytes.rates",name:$localize`Read bytes`,comparator:(n,i,_,s)=>t("stats.rd_bytes.latest",_,s),cellTransformation:N.x.sparkline,flexGrow:1.5},{prop:"stats.wr_bytes.rates",name:$localize`Write bytes`,comparator:(n,i,_,s)=>t("stats.wr_bytes.latest",_,s),cellTransformation:N.x.sparkline,flexGrow:1.5},{prop:"stats.rd.rate",name:$localize`Read ops`,flexGrow:1,pipe:this.dimlessPipe,cellTransformation:N.x.perSecond},{prop:"stats.wr.rate",name:$localize`Write ops`,flexGrow:1,pipe:this.dimlessPipe,cellTransformation:N.x.perSecond}],this.taskListService.init(()=>this.ecpService.list().pipe((0,Li.mergeMap)(n=>(this.ecProfileList=n,this.poolService.getList()))),void 0,n=>{this.pools=this.transformPoolsData(n),this.tableStatus=new ze.m},()=>{this.table.reset(),this.tableStatus=new ze.m(Ai.k.ValueException)},n=>n.name.startsWith(`${Ve}/`),(n,i)=>i.metadata.pool_name===n.pool_name,{default:n=>new Ii(n.pool_name)})}updateSelection(t){this.selection=t}deletePoolModal(){const t=this.selection.first().pool_name;this.modalService.show(Be.D,{impact:Di.r.high,itemDescription:"Pool",itemNames:[t],submitActionObservable:()=>this.taskWrapper.wrapTaskAroundCall({task:new $.O(`${Ve}/${g.Qp.DELETE}`,{pool_name:t}),call:this.poolService.delete(t)})})}getPgStatusCellClass(t,n,i){return{"text-right":!0,[`pg-${this.pgCategoryService.getTypeByStates(i)}`]:!0}}getErasureCodeProfile(t){let n="";return p().forEach(this.ecProfileList,i=>{i.name===t&&(n=`EC: ${i.k}+${i.m}`)}),n}transformPoolsData(t){const n=["bytes_used","max_avail","avail_raw","percent_used","rd_bytes","wr_bytes","rd","wr"],i={latest:0,rate:0,rates:[]};return p().forEach(t,_=>{_.pg_status=this.transformPgStatus(_.pg_status);const s={};if(p().forEach(n,d=>{s[d]=_.stats&&_.stats[d]?_.stats[d]:i}),_.stats=s,_.usage=s.percent_used.latest,!_.cdExecuting&&_.pg_num+_.pg_placement_num!==_.pg_num_target+_.pg_placement_num_target&&(_.cdExecuting="Updating"),["rd_bytes","wr_bytes"].forEach(d=>{_.stats[d].rates=_.stats[d].rates.map(O=>O[1])}),_.cdIsBinary=!0,"erasure"===_.type){const d=_.erasure_code_profile;_.data_protection=this.getErasureCodeProfile(d)}"replicated"===_.type&&(_.data_protection=`replica: \xd7${_.size}`)}),t}transformPgStatus(t){const n=[];return p().forEach(t,(i,_)=>{n.push(`${i} ${_}`)}),n.join(", ")}getSelectionTiers(){if(typeof this.expandedRow<"u"){const t=this.expandedRow.tiers;this.cacheTiers=this.pools.filter(n=>t.includes(n.pool))}}getDisableDesc(){return!this.selection?.hasSelection||!this.monAllowPoolDelete&&$localize`Pool deletion is disabled by the mon_allow_pool_delete configuration setting.`}setExpandedRow(t){super.setExpandedRow(t),this.getSelectionTiers()}static{this.\u0275fac=function(n){return new(n||Te)(e.\u0275\u0275directiveInject(Ae.m),e.\u0275\u0275directiveInject(Me.a),e.\u0275\u0275directiveInject(T),e.\u0275\u0275directiveInject(qe.v),e.\u0275\u0275directiveInject(Ze.D),e.\u0275\u0275directiveInject($i.V),e.\u0275\u0275directiveInject(Fi.v),e.\u0275\u0275directiveInject(bi.u),e.\u0275\u0275directiveInject(Xe.E),e.\u0275\u0275directiveInject(Ti.s),e.\u0275\u0275directiveInject(g.Ss))}}static{this.\u0275cmp=e.\u0275\u0275defineComponent({type:Te,selectors:[["cd-pool-list"]],viewQuery:function(n,i){if(1&n&&(e.\u0275\u0275viewQuery(He.O,5),e.\u0275\u0275viewQuery(Ji,7),e.\u0275\u0275viewQuery(Ki,5)),2&n){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.table=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.poolUsageTpl=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(i.poolConfigurationSourceTpl=_.first)}},features:[e.\u0275\u0275ProvidersFeature([Ze.D,{provide:Xe.E,useValue:new Xe.E(Ve)}]),e.\u0275\u0275InheritDefinitionFeature],decls:10,vars:2,consts:()=>{let t,n,i;return t=$localize`:␟1d8a7c8aea58294a3c57c23af0468ddf0ba0c9c7␟2795615137353856148:Pools List`,n=$localize`:␟5e7f4b1ca49e8d217bd0e12c6f7d6b6a2ade2c18␟4352555506458562289:Overall Performance`,i=$localize`:␟1e0d0117b2abb9d830ee7742280b2388ac110718␟6164763932138779244:Ceph pools overview`,[["nav","ngbNav"],["poolUsageTpl",""],["table",""],t,n,["ngbNav","",1,"nav-tabs"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","",4,"cdScope"],[3,"ngbNavOutlet"],["id","pool-list","selectionType","single",3,"fetchData","setExpandedRow","updateSelection","data","columns","hasDetails","status","autoReload"],["id","pool-list-actions",1,"table-actions",3,"permission","selection","tableActions"],["id","pool-list-details",3,"selection","permissions","cacheTiers",4,"cdTableDetail"],["id","pool-list-details",3,"selection","permissions","cacheTiers"],["title",i,"uid","z99hzWtmk","grafanaStyle","two",3,"grafanaPath","type"],["decimals","2",3,"total","used","title",4,"ngIf"],["decimals","2",3,"total","used","title"]]},template:function(n,i){if(1&n&&(e.\u0275\u0275elementStart(0,"nav",5,0),e.\u0275\u0275elementContainerStart(2,6),e.\u0275\u0275elementStart(3,"a",7),e.\u0275\u0275i18n(4,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Yi,4,8,"ng-template",8),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275template(6,e_,4,0,"ng-container",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"div",10),e.\u0275\u0275template(8,n_,1,1,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&n){const _=e.\u0275\u0275reference(1);e.\u0275\u0275advance(6),e.\u0275\u0275property("cdScope","grafana"),e.\u0275\u0275advance(),e.\u0275\u0275property("ngbNavOutlet",_)}},dependencies:[h.NgIf,E.NgbNavContent,E.NgbNav,E.NgbNavItem,E.NgbNavLink,E.NgbNavLinkBase,E.NgbNavOutlet,yi.o,et.c,He.O,xi.j,Ui.N,Gi.V,Fe],styles:["cd-pool-list .pg-clean{color:#008a00}  cd-pool-list .pg-working{color:#25828e}  cd-pool-list .pg-warning{color:#d48200}  cd-pool-list .pg-unknown{color:#dc3545}"]})}}var o_={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1z M8,14c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S11.3,14,8,14z"}},{elem:"circle",attrs:{cx:"8",cy:"11.8",r:".8"}},{elem:"path",attrs:{d:"M8.5,4H7.8C6.5,4,5.5,5,5.5,6.2c0,0,0,0,0,0v0.2h1V6.2C6.5,5.6,7.1,5,7.8,5h0.8c0.7,0,1.2,0.6,1.2,1.2S9.2,7.5,8.5,7.5h-1\tv2.2h1V8.5c1.2,0,2.2-1,2.2-2.2S9.7,4,8.5,4z"}}],name:"help",size:16},i_={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M12,7H6V4c0-1.1,0.9-2,2-2s2,0.9,2,2h1c0-1.7-1.3-3-3-3S5,2.3,5,4v3H4C3.4,7,3,7.4,3,8v6c0,0.6,0.4,1,1,1h8c0.6,0,1-0.4,1-1\tV8C13,7.4,12.6,7,12,7z M12,14H4V8h8V14z"}}],name:"unlocked",size:16},__=r(94097);class y{constructor(t){this.iconService=t,this.iconService.registerAll([o_,i_,__.A])}static{this.\u0275fac=function(n){return new(n||y)(e.\u0275\u0275inject(he.IconService))}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:y})}static{this.\u0275inj=e.\u0275\u0275defineInjector({imports:[At._,h.CommonModule,E.NgbNavModule,Tt.G,ge.RouterModule,l.ReactiveFormsModule,E.NgbTooltipModule,Nt.BlockModule,he.IconModule]})}}const a_=[{path:"",component:Te},{path:g.Qp.CREATE,component:D,data:{breadcrumbs:g.yY.CREATE}},{path:`${g.Qp.EDIT}/:name`,component:D,data:{breadcrumbs:g.yY.EDIT}}];class Ne{static{this.\u0275fac=function(n){return new(n||Ne)}}static{this.\u0275mod=e.\u0275\u0275defineNgModule({type:Ne})}static{this.\u0275inj=e.\u0275\u0275defineInjector({imports:[y,ge.RouterModule.forChild(a_)]})}}}}]);
//# sourceMappingURL=src_app_ceph_pool_pool_module_ts.js.map